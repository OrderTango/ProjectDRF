{% extends 'operationalpanelbase.html' %}
{% block content %}
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/operationalpanel.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/placeOrder.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/styles.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'css/jquery-ui.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'datatables/css/datatables.min.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'datatables/css/responsive.bootstrap4.min.css' %}"/>

<script type="text/javascript" src="{% static 'datatables/js/datatables.min.js' %}"></script>
<script type="text/javascript" src="{% static 'datatables/js/dataTables.responsive.min.js' %}"></script>
<script src ="{% static 'js/jquery-ui.js' %}"></script>
<script src ="{% static 'js/script.js' %}"></script>
<style>
        .deliveryAddressalign{
        word-break: break-word;
        }
        .ui-dialog-content{
            color:red !important;
            font-size: 17px ;
        }
        .ui-dialog{
            width: 35% !important;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%) !important;
            background-color: white;

        }
        .ui-dialog-buttonpane{
            padding: 0em !important;
        }
        .ui-dialog-titlebar{
            background-color: #cbc1e8;
            color: black;
            font-weight: bold;
        }
        .ui-dialog-buttonset{
            justify-content: middle;
        }
        #selectSupplierTab{
            padding-top: 5px
        }
        #chooseSupplierSelectbox, #selectSupplierSelectbox{
            height: 30;
            padding: 0px 5px 3px 5px !important;
        }
        .ui-datepicker{
            width: 98% !important;
        }
        .ui-datepicker select.ui-datepicker-year {
            width: 30%;
            background: none;
            border: 1px solid #9e4faa;
            border-radius: 5px;
            height:1.65em;
        }
        .ui-datepicker select.ui-datepicker-month {
            width: 50%;
            background: none;
            border: 1px solid #9e4faa;
            border-radius: 5px;
            height:1.65em;
        }
        .containern {
          width: 100px;
          height: 2px;
          position: relative;
        }
        #menuTab{
            margin-bottom:-1px;
        }
.circlenew{
  display: inline-block;
  vertical-align: middle;
  width: 30px;
  height: 30px;
  background-color: white;
  border: solid 1px black;
  border-radius: 50%;
  position: absolute;
  top: -15px;
}
#circle1 {
  left: calc(87%);
    z-index: 1;
}
#circle2 {
  left: calc(95%);
   z-index: 1;
}
#circle3 {
  left: calc(100%);
  z-index: 1;
}
#circle4 {
  left: calc(66%);
}
.dropselect{
    top: -17px;
    position: absolute;
    left: calc(0%);
}
.blue {
  background: #e6e6e6;
}
.circlenew {
  background: #ccc;
  border-color: yellow;
}
.liClassRow{
   margin: 2% 0% 2.5% 4% !important;
}
.offset-md-1 {
    margin-left: 3.333333% !important;
}
.activeCircle {
    border: 2px solid #ffd500;
    background-color: #9f6ea1
}
table.dataTable {
    margin-top: 0% !important;
    margin-bottom: 1% !important;
    margin-left: 1.5% !important;
    border-collapse: collapse !important;
}
thead {
    border: 1px solid #edeac0;
    background-color: #fdf7e3
}
.page-link {
    background-color: #fffdf2 !important
}
.goodsReceiveTextBox,.goodsIssueTextBox{
    width:60px;
    border: 1px solid #bb99c0;
    border-radius: 8px;
}
.dropdownNew,
.dropdownNew li,
.dropdownNew ul {
    list-style:none;
    margin:0;
    padding:0;
}

.dropdownNew {
    position:relative;
    float:left;
    width:100%;
}
.dropdownNew ul {
    position:absolute;
    top:100%;
    visibility:hidden;
    display:none;
    z-index:900;
    width:8em;

}
.dropdownNew ul ul {
    top:0;
    left:100%;
}


.dropdownNew li {
    position:relative;
    float:left;
}
.dropdownNew li:hover{
    z-index:910;
}

.dropdownNew ul:hover,
.dropdownNew li:hover > ul,
.dropdownNew a:hover + ul,
.dropdownNew a:focus + ul {
    visibility:visible;
    display:block;
}
.dropdownNew a {
    display:block;
    background:#9e4faa;
    color:#fff;
    padding:8px 15px 8px 15px ;
}
.dropdownNew ul li {
    width:100%;
}

.dropdownNew li:hover a {
    background:#9e4faa;
}

.dropdownNew li a:focus,
.dropdownNew li a:hover {
    background:#5b0f67;
}
.otherSupplierList {
    width: 80px !important;
    border: 1px solid #c9a6c0;
    border-radius: 8px !important;
    text-align: center;
}

.dropdownNew > li:last-child ul {
    right:0;
}
.dropdown-content {
  display: none;
  position: absolute;
  left: auto;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}
/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #ddd;}

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {display: block;}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {background-color: #3e8e41;}*/

@media (min-width:320px) and (max-width: 480px)  {
    .resDeliverTo{
        margin-left:20px !important;
        padding-bottom: 4%;
    }
    #deliveryAddress, #deliveryDate {
        margin-top: -133px !important;
        margin-left: 167% !important;
    }
    .removePaddingFromRow{
        padding-left: 15px !important;
    }
    .notify{
        margin-left:20px !important;
    }
    .ui-datepicker-multi .ui-datepicker-group table {
        margin-left: 0px;
        width: 171px !important;
        height: 140px !important;
        font: 7pt Arial, sans-serif;
        max-width: 160px !important;
    }
    .ui-datepicker-group .ui-datepicker-group-first{
        margin-left: 0px;
        width: 171px !important;
        height: 140px !important;
        font: 7pt Arial, sans-serif;
        max-width: 160px !important;
    }
    .ui-datepicker-group .ui-datepicker-group-last{
        margin-left: 0px;
        width: 171px !important;
        height: 140px !important;
        font: 7pt Arial, sans-serif;
        max-width: 160px !important;
    }
    .ui-datepicker .ui-datepicker-title {
        margin: 0em;
        text-align: center;
    }

    .ui-widget {
        font-family: Trebuchet MS,Tahoma,Verdana,Arial,sans-serif;
        font-size: 1em;
    }
    .ui-datepicker .ui-datepicker-header {
        position: relative;
        padding: 0px !important;
    }
    .ui-datepicker-inline{
        width: 20em !important;
    }
    .ui-datepicker{
        width: 20em !important;
        padding: 0px !important;
    }
    .clearDateSelection{
        margin: 0% !important;
        width: 20em !important;
    }
    .liClassRow{
        height: 10%;
    }
    #dropselect2L{
        left: calc(8%);
        top: 14px;
    }
    #dropselect1L{
        left: calc(125px);
        top: 14px;
    }
    .blue{
       background: none;
    }
    .circlenew {
        top: calc(35px)!important;
        left: calc(-175%) !important;
    }
    .resPadMob{
        margin-left: -70px !important;
        padding:10px !important;
        margin-top: 7% !important;
    }
    #deliveryAddress{
        margin-left: 157px;
        margin-top: -270px;
    }
    #deliveryDate{
        margin-top: -225px;
    }
    #circle1{
        margin-left: 164px;
        margin-top: -225px;
    }
    #circle2{
        margin-left: 101px;
        margin-top: -180px;
    }
    #circle3{
        margin-left: 37px;
        margin-top: -136px;
    }
    #circle4{
        margin-left: -42px;
        margin-top: -90px;
    }
    .activeLine{
        border: 0;
    }
    .liClassRow{
        height:0px !important;
    }
    .borderTop{
        border-top: 0;
    }
    #processBtnDiv {
        padding-top: 5%;
        margin-left: -4%;
    }
    .addProductTable {
        width: 130% !important;
    }
    #viewOrderTable_paginate {
      margin-left: 48% !important;
    }

    div.dataTables_wrapper div.dataTables_paginate ul.pagination {
      justify-content: center !important;
    }
    .orderHead {
        padding-left: 10% !important;
    }
    .pastOrdersMenus {
        margin-left: -0.5% !important;
    }
    .menuWidth{
        width: 96% !important;
    }
    .orderSubHeadRightActive {
        background-color: #fdf7e3 !important;
        margin-left: -18% !important;
    }


}
</style>
<div class="row headColor">
  <div class="col-md-2 col-sm-4 col-24" id="sideBarLeft">
        {% include "operationalpanelsidebar.html" %}
  </div>
  <div class="col-md-10 paddingLeftRightZero" id="bodyContent">
        <div class="row addMarginFiveTB marginFiveTBS">
            <div class="col-md-2 col-sm-3 col-6 orderHead">
                <a href="{% url 'placeOrder' %}" class="subHeadClass" id="orderBtn"><img src="{% static 'images/OnBoard.png' %}" class="sideBarIcons">Order</a>
            </div>
        </div>
        <div class="row addMarginFiveTB marginFiveTBS" id="menuTab">
            <div class="col-md-2 col-sm-3 col-6 orderSubHead orderSubHeadLeftActive pastOrdersMenus" id="pastOrdersMenu">
                Past Orders
            </div>
            <div class="col-md-2 col-sm-3 col-6 orderSubHead pastOrdersMenus" id="placeOrderMenu">
                Place Order
            </div>
            <div class="offset-md-6 pull-right searchDivWidth" id="searchBtnDiv">
                <span class="input-group" id="searchOptionInputGroup">
                    <input type="text" id="searchOption" maxlength="60">
                    <div class="input-group-append">
                      <span id="spanSearchIcon">
                        <i class="fa fa-search"></i>
                      </span>
                    </div>
                </span>
            </div>
        </div>
        <div class="orderMenuTab" id="placeOrderMenuTab">
            <!--<div class="row removeMarginsFromRow bgColor paddingLeftRightTen" id="orderMgmtTab">
                <ul class="col-md-4 nav nav-pills textAlignCenter" id="orderMgmtTabUL">
                    <li class="col-md-4 col-sm-4 orderMgmtTab orderMgmtTabActive" id="orderTab">
                        <a data-toggle="pill" href="#order">Order</a>
                    </li>
                    &lt;!&ndash;<li class="col-md-4 col-sm-4 orderMgmtTab" id="orderHistoryTab">
                      &lt;!&ndash; <a data-toggle="pill" href="#orderHistory">Order History</a> &ndash;&gt;
                        <a data-toggle="pill" href="">Order History</a>
                    </li>
                    <li class="col-md-4 col-sm-4 orderMgmtTab" id="notificationTab">
                        &lt;!&ndash; <a data-toggle="pill" href="#notification">Notification</a> &ndash;&gt;
                        <a data-toggle="pill" href="">Notification</a>
                    </li>&ndash;&gt;
                </ul>
            </div>-->
            <div class="row removeMarginsFromRow bgColor paddingLeftRightTen" id="selectSupplierTab">
                <div class="col-md-5">
                    <label class="col-md-6 supplierChooseModules" id="supplierChooseModule"> Choose Vendor</label>
                    <select class="col-md-4 selectClass arrows" id="chooseSupplierSelectbox">
                    <option value="Single">Single</option>
                    <option value="Multiple">Multiple</option>
                    </select>
                </div>
                <div class="col-md-7" id="supplierSelectModule">
                    <label class="col-md-4"> Select Vendor </label>
                    <select class="col-md-4 selectClass arrows" id="selectSupplierSelectbox">
                        <option value="">Select</option>
                    </select>
                </div>
            </div>
            <div id="hidePlaceOrderModule">
                <div class="row bgColor removeMarginsFromRow paddingLeftRightTen tab-content orderMgmtModule">
                    <div id="order" class="tab-pane tabPaneClass active">
                        <div class="row textAlignCenter">
                            <div class="offset-md-1 col-md-2 resPadMob" ><span class="orderSubLi 421 orderSubLiActiveTo" id="placeOrderTabOne">Deliver-to</span></div>
                            <div class="col-md-2 resPadMob"><span class="orderSubLi orderSubLiActive orderSubLiActiveDate" id="placeOrderTabTwo">Delivery Date</span></div>
                            <div class="col-md-2 resPadMob"><span class="orderSubLi orderProcessLink" id="placeOrderTabThree">Place Order</span></div>
                            <div class="col-md-2 resPadMob"><span class="orderSubLi orderProcessLink" id="placeOrderTabFour">Review Order</span></div>
                            <div class="col-md-2 resPadMob"><span class="orderSubLi orderProcessLink" id="placeOrderTabFive">Confirm Order</span></div>
                            <div class="col-md-1 resPadMob"><span class="orderSubLi orderProcessLink" id="placeOrderTabSix" style="padding-left: 20px;">End</span></div>
                        </div>
                    </div>
                    <div id="orderHistory" class="tab-pane tabPaneClass">
                        sample order history
                    </div>
                    <div id="notification" class="tab-pane tabPaneClass">
                        sample notification
                    </div>
                </div>
                <div class="row removeMarginsFromRow paddingLeftRightTen liClassRow" id="deliverOrderDiv">

                <div class="col-md-2 col-sm-2 col-2 containern blue bAddress" id="dropselect2L">
                   <div class="dropselect">
                       <select class="selectClass arrows" disabled id="deliveryAddress"> </select>
                   </div>
                </div>
                <div class="col-md-2 col-sm-2 col-2 containern blue " id="dropselect1L">
                     <div class="dropselect">
                       <select class="selectClass arrows" disabled id="deliveryDate"></select>
                   </div>
                </div>
                <div class="col-md-1 col-sm-1 col-1 containern blue" id="circle01L">
                      <div class="circlenew orderProcessBtn" id="circle1">

              </div>
                </div>
                <div class="col-md-1 col-sm-1 col-1 containern blue aAddress" id="circle1L">

              </div>
              <div class="col-md-1 col-sm-1 col-1 containern blue" id="circle02L">
                <div class="circlenew orderProcessBtn" id="circle2">

                </div>
              </div>
              <div class="col-md-1 col-sm-1 col-1 containern blue" id="circle2L">

              </div>
              <div class="col-md-1 col-sm-1 col-1 containern blue" id="circle03L">
               <div class="circlenew orderProcessBtn" id="circle3">

               </div>
              </div>
              <div class="col-md-1 col-sm-1 col-1 containern blue" id="circle3L">

              </div>
              <div class="col-md-1 col-sm-1 col-1 container blue" id="circle04L">
                <div class="circlenew orderProcessBtn" id="circle4">

                </div>
              </div>

             <div class="col-md-1">

              </div>

                </div>
                <div id="deliverDataDiv">
                    <div class="row removeMarginsFromRow paddingLeftRightTen paddingTopTen">
                        <div class="col-md-4 col-12 resDeliverTo">
                            <div class="row " style="padding-bottom: 3.5%">
                              <div class="col-md-12"><img class="sideBarIcons1X sideBarIconMargin" src="{% static 'images/deliveryto.png' %}" alt="delivery_icon"><span class="subNavTitle">Deliver To</span></div>
                            </div>
                            <div class="row removePaddingFromRow" id="deliverLocationHead">
                                <div class="col-md-6 col-6 removePaddingFromRow" id="deliverTitleHead">
                                    <img class="sideBarIcons1X" src="{% static 'images/deliveryto.png' %}" alt="delivery_icon"><span id="deliLocaHead" style="font-size: 13px; margin-left: 5px;">Delivery Location</span>
                                </div>
                                <div class="col-md-6 col-6 removePaddingFromRow" id="deliAddressHead">
                                    <select class="selectClass arrows" id="selectDeliveryAddress"></select>
                                </div>
                            </div>
                            <div class="row removePaddingFromRow" id="addressHead">
                                Address
                            </div>
                            <div class="row removePaddingFromRow" id="addressDetail">
                                <div class="col-md-10 removePaddingFromRow"><span class="addressDetail deliveryAddressalign" id="addressLine1"></span></br>
                                <span class="addressDetail deliveryAddressalign" id="addressLine2"></span><span class="addressDetail" id="unitOneAndTwo"></span></br>
                                    <span class="addressDetail" id="addstate"></span></br>
                                    <span class="addressDetail" id="addcountry"></span><span class="addressDetail" id="addpostalCode"></span>
                                </div>
                            </div>
                            <div class="row removePaddingFromRow" id="addressFooter">

                            </div>
                        </div>
                        <div class="col-md-8 removePaddingFromRow">
                           <div class="row sideTabWid" id="sideTabMenu">
                                <div class="col-md-8">
                                    <img class="sideBarIcons1X" src="{% static 'images/calendar.png' %}" alt="date_icon"><span class="subNavTitle">Select Date</span>
                                    <div class="pull-right"><img class="sideBarIcons1X" src="{% static 'images/timelog.png' %}" alt="date_icon"><span class="subNavTitle">Time Slot</span><span><select id="deliverySlot" class="selectClass arrows" type="dropdown" ></select></span><span><select id="timeSlot" class="selectClass arrows" type="dropdown"></select></span></div>
                                </div>
                                <div class="col-md-4">
                                    <a href='#' class='orderProcessBtn' id='placeOrder'> <img class='img-responsive pull-right' style='height:30px' src='{% static "images/placeOrder.png" %}' alt=''/></a>
                                </div>
                            </div>
                            <div id="datepicker-2"></div>
                            <div class="clearDateSelection" id="clearDate">Clear Date Selection</div>
                        </div>
                    </div>
                </div>

            </div><br />
            <div id="placeOrderDiv">
                <div class="row">
                    <div class="offset-md-1 col-md-1" id="categoryDataDiv">
                        <p>Filter By: </p>
                    </div>
                    <div class="col-md-4 col-sm-3 col-8" id="categoryDataDiv">
                        <select id="select_category" class="select_catsub">
                            <option value="Category">Category</option>
                        </select>
                        <select id="select_suppliers" class="select_catsub">
                            <option value="">Suppliers</option>
                        </select>
                    </div>
                    <div class="col-md-6 col-sm-3 col-8" id="processBtnDiv">
                        <div class="pull-right">
                           <a href="#" class="toggle-vis" id="toggle-vis" data-column="4" style="text-decoration:none;color:#000;"><img class="img-responsive" style="height:30px" src="{% static 'images/showhide.png' %}" alt=""/></a>
                           <a href="#" class="toggle-vis1" id="toggle-vis1" data-column="7" style="text-decoration:none;color:#000;"><img class="img-responsive" style="height:30px" src="{% static 'images/showhidetotal.png' %}" alt=""/></a>
                            <span class="addToCartClass"><img class='img-responsive addToCart' style='height:30px;cursor: pointer;' src='{% static "images/addtocart.png" %}' alt=''/></span>
                           <a href="#" class="orderProcessBtn" id="reviewOrder"><img class="img-responsive" style="height:30px" src="{% static 'images/revieworder.png' %}" alt=""/></a>
                           <span class="input-group" id="searchOptionInputGroupOrder">
                                <input type="text" id="searchOptionOrder" maxlength="60">
                                <div class="input-group-append">
                                  <span id="spanSearchIconOrder">
                                    <i class="fa fa-search"></i>
                                  </span>
                                </div>
                           </span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="offset-md-4 col-md-8">
                        <div class="pull-right">

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-sm-3 col-10 ">
                        <table class="table hover dt-responsive addProductTable" id="addProductTable" width="100%">
                             <thead>

                             </thead>
                         </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="orderMenuTab" id="pastOrdersMenuTab">
            <div class="row">
                <div class="col-md-12 col-sm-3 col-6" align="center" >
                    <table class="table hover dt-responsive viewOrderTable responWidth" id="viewOrderTable" width="100%" style="font-size:85%">
                         <thead>

                         </thead>
                     </table>
                </div>
            </div>
        </div>
  </div>

</div>
    {% include "rightsidebar.html" %}
</div>
<div class="modal fade" id="exampleModalCenter" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content modalBorderClass">
          <div class="modal-header">
            <h5 class="modal-title modalTitleHead" id="exampleModalLongTitle"> </h5>
               <span id="modalCloseBtn">

              </span>
          </div>
          <div class="modal-body">
              <div id="success_msg" class="success_msg"> </div>
              <div id="error_msg" class="error_msg"> </div>
                <form role="form" autocomplete="off">
                    {% csrf_token %}
                    <div id="modalBody">

                    </div>
                </form>
          </div>
          <div class="modal-footer" id="modalFooter">

          </div>
        </div>
      </div>
    </div>
<!-- The Modal -->
<div class="modal" id="viewPlacedOrderModal" tabindex="-1" data-backdrop="static" data-keyboard="false" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog viewPlacedOrderModaldia" style="max-width: 80% !important;">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title" id="viewPlacedOrderModalTitle"> View Placed Orders</h4>
        <button type="button" class="close viewPlacedOrderModalClose" data-dismiss="modal" aria-hidden="true">x</button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="row" >
            <div class="col-md-12 col-sm-3 col-6 " >
                <table class="table hover dt-responsive viewPlacedOrderDataTable" id="viewPlacedOrderDataTable" width="100%" style="font-size:85%">
                     <thead>

                     </thead>
                 </table>
            </div>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn viewPlacedOrderModalClose" id="viewPlacedOrderModalClose" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>

<div class="modal" id="confirmModalPopup" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="sampleModalPopupTitle" data-toggle="modal" data-backdrop="static" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered confirmModalPopup" role="document">
        <div class="modal-content modalBorderClass">
          <div class="modal-header">
            <h5 class="modal-title modalTitleHead" id="confirmModalPopupTitle"></h5>
            <button type="button" class="close" id="confirmModalPopupCloseBtn" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" id="confirmModalPopupBodyContent">


          </div>
          <div class="modal-footer" class="row" style="text-align:center">
              <div class="col-md-12">
                  <input type="button" id="confirmModalPopupSubmit" class="btn btn-primary modalBtnClass" data-dismiss="modal" aria-label="Close" value="Confirm">
                <input type="button" id="confirmModalPopupClose" class="btn btn-primary modalBtnClass" data-dismiss="modal" aria-label="Close" value="Cancel">
              </div>
          </div>
        </div>
      </div>
    </div>

<div class="modal" id="confirmNewOrderModalPopup" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false"  data-toggle="modal" data-backdrop="static" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered confirmNewOrderModalPopup" role="document" style="max-width:80%">
        <div class="modal-content modalBorderClass">
          <div class="modal-header">
            <h5 class="modal-title modalTitleHead" id="confirmNewOrderModalPopupTitle"></h5>
            <button type="button" class="close" id="confirmNewOrderModalPopupCloseBtn" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body" id="confirmNewOrderModalPopupBodyContent">
            <table class="table hover dt-responsive newOrderDataTable responWidth" id="newOrderDataTable" width="100%" style="font-size:85%">
                 <thead>

                 </thead>
             </table>
          </div>
          <div class="modal-footer" class="row" style="text-align:center">
              <div class="col-md-12">
                  <input type="button" id="confirmNewOrderModalPopupSubmit" class="btn btn-primary modalBtnClass" data-dismiss="modal" aria-label="Close" value="Confirm">
                <input type="button" id="confirmNewOrderModalPopupClose" class="btn btn-primary modalBtnClass" data-dismiss="modal" aria-label="Close" value="Cancel">
              </div>
          </div>
        </div>
      </div>
    </div>

<script>
$body = $("body");
var addProductTable = $('#addProductTable').DataTable({
    "bFilter": false,
    "bLengthChange": false,
    "targets": 'no-sort',
    "bSort": false,
    "info": false,
    "searching": true,
    "order": [],
    "pagingType": "full_numbers",
    language: {
            paginate: {
                previous: false,
                next: false,
                first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
            }
    },
     "columns": [
            { "title": "S.No" },
            { "title": "Product Code" },
            { "title": "Product Name"},
            { "title": "Category"},
            { "title": "Price"},
            { "title": "UOM"},
            { "title": "Qty"},
            { "title": "Total"},
            { "title": "Status"},
            { "title": "Action"}

        ],
        columnDefs: [
             { "width": "2%", "targets": 0 },
             { "width": "10%", "targets": 1 },
             { "width": "15%", "targets": 2 },
             { "width": "10%", "targets": 3 },
             { "width": "10%", "targets": 4 },
             { "width": "10%", "targets": 5 },
             { "width": "10%", "targets": 6 },
             { "width": "10%", "targets": 7 },
             { "width": "10%", "targets": 8 },
             { "width": "10%", "targets": 9 }

        ],
    responsive: {
        details: {
            renderer: $.fn.dataTable.Responsive.renderer.tableAll()
        }
    }

 });

$('#supplierSelectModule').css('display','none');
$('#hidePlaceOrderModule').css('display','none');

Array.prototype.multiIndexOf = function (el) {
    var idxs = [];
    for (var i = this.length - 1; i >= 0; i--) {
        if (this[i] === el) {
            idxs.unshift(i);
        }
    }
    return idxs;
};
$(document).ready(function() {
$('#deliverySlot').hide();
$(document).on('change', '#selectSupplierSelectbox', function() {
    myaddProductTableList = [];
    addToCartPushData = [];
      if($('#selectSupplierSelectbox').val() != 'Select'){
           $("#datepicker-2").datepicker("destroy");
           $('#deliverySlot').show();
           var data = {"siteId":$('#selectDeliveryAddress').val(),"supplierId":$('#selectSupplierSelectbox').val()};
           onChangeSupplierOrSite(data);
      }
      else{
        onChangeSupplierValue('Multiple');
        $('#supplierSelectModule').css('display','block');
        alert('Please select vendor');
        $('#deliverySlot').empty();
        $('#timeSlot').empty();
        $('#deliverySlot').show();
        return false;
      }
});

function onChangeSupplierOrSite(data) {
    $.ajax({
      url: "/slaDetails",
      type: "POST",
      dataType : "json",
      contentType : "application/json",
      data: JSON.stringify(data),
      success: function (result)
      {
        var data = result;
        if (data.status == 'success') {
            $('#timeSlot').empty();
            $("#timeSlot").prop('disabled', true);
            $('#deliverySlot').empty();
            for(i = 0; i < data.totalItems[0].sla.deliverySlot.length; i++){
            $('#timeSlot').append($('<option>', {value:data.totalItems[0].sla.deliverySlot[i].deliverySlot, text:data.totalItems[0].sla.deliverySlot[i].deliverySlot}));
            $('#deliverySlot').append($('<option>', {value:data.totalItems[0].sla.deliverySlot[i].deliverySlot, text:data.totalItems[0].sla.deliverySlot[i].slotName}));
            }
            $('#hidePlaceOrderModule').css('display','block');
            var workingDays = data.totalItems[0].sla.deliveryDays;
            var holidayDate = data.totalItems[0].sla.holidayDate;
            var holidayDateArr = [];

             for(i = 0; i < holidayDate.length; i++){
                holidayDateArr.push(holidayDate[i].holidayDate);
             }
             if(data.totalItems[0].hideDate != 1) {
             holidayDateArr.push(data.totalItems[0].hideDate);
             }
            var workingDaysData = workingDays.multiIndexOf(0);
            /* Datepicker Start */
            var unavailableDates = holidayDateArr;
            function unavailable(date) {
                dmy = ("0" + date.getDate()).slice(-2)+ "/"+("0" + (date.getMonth() + 1)).slice(-2)  +  "/" + date.getFullYear();
                if ( $.inArray(date.getDay(), workingDaysData) == -1 && $.inArray(dmy, unavailableDates) == -1) {
                    return [true, ""];
                }
                else{
                    return [false, "", "Unavailable"];
                }
            }
            $("#datepicker-2").datepicker({monthNamesShort:["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],changeMonth: true,changeYear: true, dateFormat: 'dd/mm/yy', beforeShowDay: unavailable, minDate: data.totalItems[0].sla.orderingSchedule, numberOfMonths: 2, showOtherMonths: true, dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']});
            $("#datepicker-2").on("change",function() {
                $('#deliveryDate').empty();
                $('#deliveryDate').append($("<option />").val($(this).val()).text($(this).val()));
            });
            $('#clearDate').on('click', function () {
                $( "#datepicker-2" ).datepicker('setDate', null);
                $('#deliveryDate').empty();
            });
        /* Datepicker End */
                var catsup = new Object();
                var sup = new Array();
                catsup.single = "single";
                catsup.cat = " ";
                catsup.sup = $('#selectSupplierSelectbox').val();
                catsup.type = "customer";
            $.ajax({
              url: "/listOfItemsSupplierOrCustomer",
              type: "POST",
              dataType : "json",
              contentType : "application/json",
              data: JSON.stringify(catsup),
              success: function (result)
              {
                var data = result;
                if (data.status == 'success') {
                $(".orderProcessLink").css("pointer-events","auto");
                $(".orderProcessBtn").css("pointer-events","auto");
                $('#select_suppliers').empty();
                 for(i = 0; i < data.totalItems[0].totalSupplier.length; i++){
                    $('#select_suppliers').append($('<option>', {value:data.totalItems[0].totalSupplier[i].relId, text:data.totalItems[0].totalSupplier[i].trdersId__companyName}));
                 }
                 $('#select_category').empty();
                 $('#select_category').append($('<option>', {value:"Category", text:"Category"}))
                 for(i = 0; i < data.totalItems[0].totalCategory.length; i++){
                    $('#select_category').append($('<option>', {value:data.totalItems[0].totalCategory[i].prtCatId, text:data.totalItems[0].totalCategory[i].prtCatName}));
                 }
                 addProductTableList = data.totalItems[0].totalItem;
                 pullProductTable(addProductTableList,"productAdd");
              }
              else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                    alert('Session has expired.');
                    setTimeout(function() {
                        window.location.href = data.redirect_url;
                    }, 2000);

                }else{
                addProductTable.clear().draw();
                addProductTableList = [];
                alert(data.error_msg);
               }

              }
            });
       }

       else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
            alert('Session has expired.');
            setTimeout(function() {
                window.location.href = data.redirect_url;
            }, 2000);
       }
       else{
        alert(data.error_msg);
       }
      }
    });

}
$(document).on('change', '#chooseSupplierSelectbox', function() {
myaddProductTableList =[];
	var chooseSupplier = $('#chooseSupplierSelectbox').val();
	onChangeSupplierValue(chooseSupplier);
});

$(document).on('change', '#deliverySlot', function() {
	var timeSlot = $('#deliverySlot').val();
	$('#timeSlot').empty();
	$('#timeSlot').append($('<option>', {value:timeSlot, text:timeSlot}));
});

/* Single Or Multiple Supplier Start */
    $('#chooseSupplierSelectbox').val('Multiple');
    onChangeSupplierValue($('#chooseSupplierSelectbox').val());
/* Single Or Multiple Supplier End */

function onChangeSupplierValue(chooseSupplier) {
addProductTable.clear().draw();
    if(chooseSupplier != 'Select') {
        if(chooseSupplier == 'Single'){
            $('#deliveryDate').empty();
            $('#deliverySlot').empty();
            $('#timeSlot').empty();
            $('#deliverySlot').show();
            $('#selectSupplierSelectbox').empty();
            $.ajax({
              url: "/getSupplier",
              type: "get",
              dataType : "json",
              contentType : "application/json",
              success: function (result)
              {
                var data = result;
                if (data.status == 'success') {
                 $('#selectSupplierSelectbox').append($('<option>', {value:"Select", text:"Select"}));
                 for(i = 0; i < data.totalItems[0].totalItem.length; i++){
                    $('#selectSupplierSelectbox').append($('<option>', {value:result.totalItems[0].totalItem[i].supplierId, text:result.totalItems[0].totalItem[i].supCompanyName}));
                 }
                 }else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                alert('Session has expired.');
                setTimeout(function() {
                    window.location.href = data.redirect_url;
                }, 2000);

            }else{
            alert(data.error_msg);
           }
              }
            });
            $('#hidePlaceOrderModule').css('display','block');
            $('#supplierSelectModule').css('display','block');
        }
        else if(chooseSupplier == 'Multiple'){

        var data = {"type":"customer"};
                $.ajax({
                  url: "/listOfItemsSupplierOrCustomer",
                  type: "POST",
                  dataType : "json",
                  contentType : "application/json",
                  data: JSON.stringify(data),
                  success: function (result)
                  {
                    var data = result;

                    if (data.status == 'success') {
                    $('#select_suppliers').empty();
                     $('#select_suppliers').append($('<option>', {value:"", text:"Supplier"}))
                     for(i = 0; i < data.totalItems[0].totalSupplier.length; i++){
                        $('#select_suppliers').append($('<option>', {value:data.totalItems[0].totalSupplier[i].relId, text:data.totalItems[0].totalSupplier[i].trdersId__companyName}));
                     }
                     $('#select_category').empty();
                     $('#select_category').append($('<option>', {value:"Category", text:"Category"}))
                     for(i = 0; i < data.totalItems[0].totalCategory.length; i++){
                        $('#select_category').append($('<option>', {value:data.totalItems[0].totalCategory[i].prtCatId, text:data.totalItems[0].totalCategory[i].prtCatName}));
                     }
                     addProductTableList = data.totalItems[0].totalItem;
                     addToCartPushData = [];
                  }
                  else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                        alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);

                    }
                    else{
                        alert(data.error_msg);
                    }

                  }
                });

            $('#timeSlot').empty();
             $("#timeSlot").prop('disabled', false);
            $('#deliverySlot').hide();
            $('#deliveryDate').empty();
            $('#timeSlot').append($('<option>', {value:"9:00am-12:00pm", text:"9:00am-12:00pm"}));
            $('#timeSlot').append($('<option>', {value:"12:00pm-3:00pm", text:"12:00pm-3:00pm"}));
            $('#timeSlot').append($('<option>', {value:"3:00pm-6:00pm", text:"3:00pm-6:00pm"}));
            $("#datepicker-2").datepicker("destroy");
                       /* Datepicker Start */
                        var workingDays = [1,1,1,1,1,1,1];
                        var workingDaysData = workingDays.multiIndexOf(0);
                        function available(d) {
                                var day = d.getDay();
                                var status = false;
                                if ($.inArray(day, workingDaysData) == -1) {
                                    status = true;
                                }
                                return [status];
                            }

                        $( "#datepicker-2" ).datepicker({monthNamesShort: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],changeMonth: true,changeYear: true,dateFormat: 'dd/mm/yy', beforeShowDay: available, minDate: 1, numberOfMonths: 2, showOtherMonths: true, dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']});
                        $("#datepicker-2").on("change",function() {
                            $('#deliveryDate').empty();
                            $('#deliveryDate').append($("<option />").val($(this).val()).text($(this).val()));
                        });
                        $('#clearDate').on('click', function () {
                            $( "#datepicker-2" ).datepicker('setDate', null);
                            $('#deliveryDate').empty();
                        });
                    /* Datepicker End */
            $('.ui-datepicker-inline').css('width','100%');
            $('#supplierSelectModule').css('display','none');
            $('#hidePlaceOrderModule').css('display','block');
            }
		}
		else{
		    $('#selectSupplierSelectbox').find('option[value="Select"]').attr("selected",true);
		    $('#supplierSelectModule').css('display','none');
            $('#hidePlaceOrderModule').css('display','none');
		}
}

  $('.ui-datepicker-inline').css('width','100%');

  var newOrderDataTable = $('#newOrderDataTable').DataTable( {"bFilter": false,
        "lengthChange": false,
        "targets": 'no-sort',
        "bSort": false,
        "info": false,
        "searching": true,
        "order": [],
        "pagingType": "full_numbers",
        language: {
                paginate: {
                    previous: false,
                    next: false,
                    first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                    last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                }
            },
        "columns": [
                { "title": "S.No" },
                { "title": "Product Code" },
                { "title": "Product Name"},
                { "title": "Category"},
                { "title": "Quantity"},
                { "title": "UOM"},
                { "title": "Price"},
                { "title": "Total Price"}

            ],
        columnDefs: [
                 { "width": "5%", "targets": 0 },
                 { "width": "10%", "targets": 1 },
                 { "width": "25%", "targets": 2 },
                 { "width": "20%", "targets": 3 },
                 { "width": "10%", "targets": 4 },
                 { "width": "10%", "targets": 5 },
                 { "width": "10%", "targets": 6 },
                 { "width": "10%", "targets": 7 },
            ],
        responsive: {
            details: {
                renderer: $.fn.dataTable.Responsive.renderer.tableAll()
            }
        }
   });

        var dataAddress = new Array();
        var addProductTableList = new Array();
        var myaddProductTableList = new Array();
        var totalPrice = 0;

        $('#placeOrderDiv').hide();

        $('#slide-submenu').on('click',function() {
            $(this).closest('.list-group').fadeOut('slide',function(){
                $('.mini-submenu').fadeIn();
            });
        });

        $('.mini-submenu').on('click',function(){
                $(this).next('.list-group').toggle('slide');
                $('.mini-submenu').hide();
         });

            function appendDynamicContent(modalHead, modalBody, modalFooter) {
                $('#exampleModalLongTitle').append(modalHead);
                $('#modalBody').append(modalBody);
                $('#modalFooter').append(modalFooter);
                $('#exampleModalCenter').modal({backdrop: 'static', keyboard: false})
                $('#exampleModalCenter').modal('toggle');
                $('#exampleModalCenter').show();
            }

        checkTreeCollapse();

        function checkTreeCollapse() {
            $(".tree-container li.tree-li").removeClass("is-child")
            $(".tree-container li.tree-li").each(function () {
                if ($(this).find("ul.tree-ul li").length > 0) {
                    $(this).addClass("is-child")
                }
            });
            $(".tree-container li.tree-li span.text").unbind("click");
            $(".tree-container li.tree-li.is-child span.text").click(function () {
                $(this).parent(".tree-li").toggleClass("diactive");
                $(this).parent(".tree-li").find(".tree-ul:first").toggleClass("diactive");
            });
        }

        $(document).on('keypress', '.qtytextbox', function(event) {
                var text = $(this).val();
                var arr = text.split('.');
                if (event.which != 8  && event.which != 0  && (event.which < 48 || event.which > 57) && (event.which != 46  || (text.indexOf('.') >= 0 && text.indexOf('.') != -1 ))) {
                   return false;
                }
                if (arr[1].length > 1){
                    return false;
                }
        });

        $(document).on("cut copy paste",".qtytextbox",function(e) {
            e.preventDefault();
        });

        $('.navTabClass').on('click', function() {
                var id = $(this).attr('id');
                $('.navTabClass').removeClass('navHeading');
                $('.navTabClass > a.anchorlink').removeClass('activeNav');
                $('#'+id+'').addClass('navHeading');
                $('#'+id+ '> a').addClass('activeNav');
        });

        $('.orderMgmtTab').on('click', function() {
            $('.orderMgmtTab').removeClass('orderMgmtTabActive');
            $('#'+$(this).attr('id')+'').addClass('orderMgmtTabActive');
        });

        $.ajax({
            url: "/getUserAddress",
            method: 'GET',
            success: function (data) {
                if (data.status == 'success') {
                    dataAddress = data.totalItems[0].site;
                    var $deliveryAddress = $("#selectDeliveryAddress");
                    var counter = 1;
                    $.each(data.totalItems[0].site, function(key, value) {
                        $deliveryAddress.append($("<option />").val(value.siteId).text(value.siteName));
                        if (counter == 1) {
                            $('#deliveryAddress').append($("<option />").val(value.siteId).text(value.siteName));
                            appendAddressContent(value);

                        }
                        counter++;
                    });

                }else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                    alert('Session has expired.');
                    setTimeout(function() {
                        window.location.href = data.redirect_url;
                    }, 2000);

                }else{
                alert(data.error_msg);
               }
            }
        });


        $('#selectDeliveryAddress').on('change', function() {
            if ($('#chooseSupplierSelectbox').val() == 'Multiple') {
                appendAddress();
            }
            else if ($('#chooseSupplierSelectbox').val() == 'Single' && $('#selectSupplierSelectbox').val() != 'Select') {
            $("#datepicker-2").datepicker("destroy");
                var data = {"siteId":$('#selectDeliveryAddress').val(),"supplierId":$('#selectSupplierSelectbox').val()};
                appendAddress();
                onChangeSupplierOrSite(data);
            }
            else if ($('#chooseSupplierSelectbox').val() == 'Single' && $('#selectSupplierSelectbox').val() == 'Select') {
                alert('Please choose the supplier');
            }
        });

        function appendAddress() {
            $('#deliveryAddress').empty();
            $('#deliveryDate').empty();
            $( "#datepicker-2" ).datepicker('setDate', null);
            $('#deliveryAddress').append($("<option />").val($('#selectDeliveryAddress option:selected').val()).text($("#selectDeliveryAddress option:selected").text()));
            $.each(dataAddress, function(key, value) {
                if (value.siteId == $('#selectDeliveryAddress option:selected').val()) {
                    appendAddressContent(value);
                }
            });
        }

        function appendAddressContent(addressContent) {
            $('.addressDetail').empty();
            $('#addressLine1').append(addressContent.siteAddress__usradd_address_Line1);
            $('#addressLine2').append(addressContent.siteAddress__usradd_address_Line2);
            $('#unitOneAndTwo').append(' #'+addressContent.siteAddress__usradd_unit1+'-'+addressContent.siteAddress__usradd_unit2);
            $('#addstate').append(addressContent.siteAddress__usradd_state__stateName);
            $('#addcountry').append(addressContent.siteAddress__usradd_country__countryName);
            $('#addpostalCode').append(addressContent.siteAddress__usradd_postalCode);
        }

        var reviewBtn = "<div class='pull-right'><a href='#' class='toggle-vis1' id='toggle-vis1' data-column='7' style='text-decoration:none;color:#000;'><img class='img-responsive' style='height:30px;margin-right:5px' src='{% static "images/showhidetotal.png" %}' alt=''/></a><a href='#' class='toggle-vis' id='toggle-vis' data-column='4' style='text-decoration:none;color:#000;'><img class='img-responsive' style='height:30px;margin-right:5px' src='{% static "images/showhide.png" %}' alt=''/></a><span class='addToCartClass'><img class='img-responsive addToCart' style='height:30px' src='{% static 'images/addtocart.png' %}' alt=''/></span><a href='#' class='orderProcessBtn' id='reviewOrder'> <img class='img-responsive' style='height:30px' src='{% static "images/revieworder.png" %}' alt=''/></a><span class='input-group' id='searchOptionInputGroupOrder'><input type='text' id='searchOptionOrder' maxlength='20'><div class='input-group-append'><span id='spanSearchIconOrder'><i class='fa fa-search'></i></span></div></span></div>";
        var confirmBtn = "<div class='pull-right'><a href='#' class='toggle-vis1' id='toggle-vis1' data-column='6' style='text-decoration:none;color:#000;'><img class='img-responsive' style='height:30px;margin-right:5px' src='{% static "images/showhidetotal.png" %}' alt=''/></a><a href='#' class='toggle-vis' id='toggle-vis' data-column='4' style='text-decoration:none;color:#000;'><img class='img-responsive' style='height:30px;margin-right:5px' src='{% static "images/showhide.png" %}' alt=''/></a><a href='#' class='orderProcessBtn' id='confirmOrder'> <img class='img-responsive' style='height:30px' src='{% static "images/confirmorder.png" %}' alt=''/></a><span class='input-group' id='searchOptionInputGroupOrder'><input type='text' id='searchOptionOrder' maxlength='20'><div class='input-group-append'><span id='spanSearchIconOrder'><i class='fa fa-search'></i></span></div></span></div>";
        var submitBtn = "<div class='pull-right'><a href='#' class='toggle-vis1' id='toggle-vis1' data-column='6' style='text-decoration:none;color:#000;'><img class='img-responsive' style='height:30px;margin-right:5px' src='{% static "images/showhidetotal.png" %}' alt=''/></a><a href='#' class='toggle-vis' id='toggle-vis' data-column='4' style='text-decoration:none;color:#000;'><img class='img-responsive' style='height:30px;margin-right:5px' src='{% static "images/showhide.png" %}' alt=''/></a><a href='#' class='orderProcessBtn' id='submitOrder'> <img class='img-responsive' style='height:30px' src='{% static "images/register/submit.png" %}' alt=''/></a><span class='input-group' id='searchOptionInputGroupOrder'><input type='text' id='searchOptionOrder' maxlength='20'><div class='input-group-append'><span id='spanSearchIconOrder'><i class='fa fa-search'></i></span></div></span></div>";

                $(document).on('click', '.toggle-vis', function(e) {
                    e.preventDefault();

                    // Get the column API object
                    var column = addProductTable.column( $(this).attr('data-column') );

                    // Toggle the visibility
                    column.visible( ! column.visible() );
                    $(e.target).toggleClass("visible-column","hidden-column");
                } );

                $(document).on('click', '.toggle-vis1', function(e) {
                    e.preventDefault();

                    // Get the column API object
                    var column = addProductTable.column( $(this).attr('data-column') );

                    // Toggle the visibility
                    column.visible( ! column.visible() );
                    $(e.target).toggleClass("visible-column","hidden-column");
                } );


           function pullProductTable(addProductTableListData,type){
            var supData = $('#chooseSupplierSelectbox').val();
            addProductTable.clear().draw();
            if(type == "reviewOrder") {
                if(supData != 'Single'){
                    addProductTable.destroy();
                     $('#addProductTable').empty();
                     addProductTable.clear().draw();
                     addProductTable = $('#addProductTable').DataTable({
                        "bFilter": false,
                        "bLengthChange": false,
                        "targets": 'no-sort',
                        "bSort": false,
                        "info": false,
                        "searching": true,
                        "order": [],
                        "pagingType": "full_numbers",
                        language: {
                                paginate: {
                                    previous: false,
                                    next: false,
                                    first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                                    last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                                }
                        },
                         "columns": [
                                { "title": "S.No" },
                                { "title": "Product Code" },
                                { "title": "Product Name"},
                                { "title": "Category"},
                                { "title": "Price"},
                                { "title": "Qty"},
                                { "title": "Total"},
                                { "title": "Vendor Name"},
                                { "title": "Available Date"},
                                { "title": "Status"},
                                { "title": "Action"}

                            ],
                            columnDefs: [
                                 { "width": "2%", "targets": 0 },
                                 { "width": "10%", "targets": 1 },
                                 { "width": "15%", "targets": 2 },
                                 { "width": "5%", "targets": 3 },
                                 { "width": "10%", "targets": 4 },
                                 { "width": "13%", "targets": 5 },
                                 { "width": "10%", "targets": 6 },
                                 { "width": "10%", "targets": 7 },
                                 { "width": "10%", "targets": 8 },
                                 { "width": "5%", "targets": 9 },
                                 { "width": "10%", "targets": 10 },

                            ],
                        responsive: {
                            details: {
                                renderer: $.fn.dataTable.Responsive.renderer.tableAll()
                            }
                        }

                     });
                     addProductTable.column(3).visible(false);
                        $.each(addProductTableListData, function( index, value ) {
                            var sno = index+1;
                            var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' value='"+value.quantity+"' id='qtytextbox"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='text'>";
                            var statusSpan = "<span name='statusbox"+value.id+"' id='statusbox"+value.id+"'>Added</span>";
                            var totalVal = value.quantity * value.price;
                            var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                            var totalPriceBox = "<span id='totalPriceBox"+value.id+"'>"+totalValData+" "+value.priceUnit__type+"</span>";
                            var action = "<input class='cartAddBtn ProductBtn' style='margin-right: 5px' id='cartAddBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Update'><input class='cartCancelBtn ProductBtnr' id='cartCancelBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Cancel'>";

                            addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,qtyinput+" "+value.uOm__type,totalPriceBox,value.supplierId__supCompanyName,value.nextDeliveryDate,statusSpan,action]).draw();

                         });
                     }
                     else{
                        addProductTable.destroy();
                     $('#addProductTable').empty();
                     addProductTable.clear().draw();
                     addProductTable = $('#addProductTable').DataTable({
                        "bFilter": false,
                        "bLengthChange": false,
                        "targets": 'no-sort',
                        "bSort": false,
                        "info": false,
                        "searching": true,
                        "order": [],
                        "pagingType": "full_numbers",
                        language: {
                                paginate: {
                                    previous: false,
                                    next: false,
                                    first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                                    last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                                }
                        },
                         "columns": [
                                { "title": "S.No" },
                                { "title": "Product Code" },
                                { "title": "Product Name"},
                                { "title": "Category"},
                                { "title": "Price"},
                                { "title": "Qty"},
                                { "title": "Total"},
                                { "title": "Status"},
                                { "title": "Action"}

                            ],
                            columnDefs: [
                                 { "width": "2%", "targets": 0 },
                                 { "width": "10%", "targets": 1 },
                                 { "width": "15%", "targets": 2 },
                                 { "width": "5%", "targets": 3 },
                                 { "width": "15%", "targets": 4 },
                                 { "width": "13%", "targets": 5 },
                                 { "width": "10%", "targets": 6 },
                                 { "width": "10%", "targets": 7 },
                                 { "width": "10%", "targets": 8 },

                            ],
                        responsive: {
                            details: {
                                renderer: $.fn.dataTable.Responsive.renderer.tableAll()
                            }
                        }

                     });

                     $.each(addProductTableListData, function( index, value ) {
                            var sno = index+1;
                            var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' value='"+value.quantity+"' id='qtytextbox"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='text'>";
                            var statusSpan = "<span name='statusbox"+value.id+"' id='statusbox"+value.id+"'>Added</span>";
                            var totalVal = value.quantity * value.price;
                            var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                            var totalPriceBox = "<span id='totalPriceBox"+value.id+"'>"+totalValData+" "+value.priceUnit__type+"</span>";
                            var action = "<input class='cartAddBtn ProductBtn' style='margin-right: 5px' id='cartAddBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Update'><input class='cartCancelBtn ProductBtnr' id='cartCancelBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Cancel'>";

                            addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,qtyinput+" "+value.uOm__type,totalPriceBox,statusSpan,action]).draw();

                         });

                     }
                }

            else if(type == "confirmOrder"){
            if(supData != 'Single'){
               addProductTable.destroy();
                 $('#addProductTable').empty();
                 addProductTable.clear().draw();
                 addProductTable = $('#addProductTable').DataTable({
                    "bFilter": false,
                    "bLengthChange": false,
                    "targets": 'no-sort',
                    "bSort": false,
                    "info": false,
                    "searching": true,
                    "order": [],
                    "pagingType": "full_numbers",
                    language: {
                            paginate: {
                                previous: false,
                                next: false,
                                first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                                last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                            }
                    },
                     "columns": [
                            { "title": "S.No" },
                            { "title": "Product Code" },
                            { "title": "Product Name"},
                            { "title": "Category"},
                            { "title": "Price"},
                            { "title": "Qty"},
                            { "title": "Total"},
                            { "title": "Available Date"},
                            { "title": "Status"},

                        ],
                        columnDefs: [
                             { "width": "2%", "targets": 0 },
                             { "width": "10%", "targets": 1 },
                             { "width": "15%", "targets": 2 },
                             { "width": "5%", "targets": 3 },
                             { "width": "15%", "targets": 4 },
                             { "width": "15%", "targets": 5 },
                             { "width": "10%", "targets": 6 },
                             { "width": "10%", "targets": 7 },
                             { "width": "10%", "targets": 8 },

                        ],
                    responsive: {
                        details: {
                            renderer: $.fn.dataTable.Responsive.renderer.tableAll()
                        }
                    }

                 });
                 addProductTable.column(3).visible(false);
             $.each(addProductTableListData, function( index, value ) {
                var sno = index+1;
                var qtyinput = value.quantity;
                var statusSpan = "<span name='statusbox"+value.id+"' id='statusbox"+value.id+"'>Added</span>";
                var totalVal = value.quantity * value.price;
                var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                var totalPriceBox = "<span id='totalPriceBox"+value.id+"'>"+totalValData+" "+value.priceUnit__type+"</span>";
                var action = "";
                totalPrice = totalPrice + (qtyinput * value.price);
                addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,qtyinput+" "+value.uOm__type,totalPriceBox,value.nextDeliveryDate,statusSpan]).draw();

             });
             }

             else{
                 addProductTable.destroy();
                 $('#addProductTable').empty();
                 addProductTable.clear().draw();
                 addProductTable = $('#addProductTable').DataTable({
                    "bFilter": false,
                    "bLengthChange": false,
                    "targets": 'no-sort',
                    "bSort": false,
                    "info": false,
                    "searching": true,
                    "order": [],
                    "pagingType": "full_numbers",
                    language: {
                            paginate: {
                                previous: false,
                                next: false,
                                first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                                last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                            }
                    },
                     "columns": [
                            { "title": "S.No" },
                            { "title": "Product Code" },
                            { "title": "Product Name"},
                            { "title": "Category"},
                            { "title": "Price"},
                            { "title": "Qty"},
                            { "title": "Total"},
                            { "title": "Status"},

                        ],
                        columnDefs: [
                             { "width": "2%", "targets": 0 },
                             { "width": "10%", "targets": 1 },
                             { "width": "15%", "targets": 2 },
                             { "width": "5%", "targets": 3 },
                             { "width": "15%", "targets": 4 },
                             { "width": "13%", "targets": 5 },
                             { "width": "10%", "targets": 6 },
                             { "width": "10%", "targets": 7 },

                        ],
                    responsive: {
                        details: {
                            renderer: $.fn.dataTable.Responsive.renderer.tableAll()
                        }
                    }

                 });

                 $.each(addProductTableListData, function( index, value ) {
                        var sno = index+1;
                        var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' value='"+value.quantity+"' id='qtytextbox"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='text'>";
                        var statusSpan = "<span name='statusbox"+value.id+"' id='statusbox"+value.id+"'>Added</span>";
                        var totalVal = value.quantity * value.price;
                        var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                        var totalPriceBox = "<span id='totalPriceBox"+value.id+"'>"+totalValData+" "+value.priceUnit__type+"</span>";
                        var action = "<input class='cartAddBtn ProductBtn' style='margin-right: 5px' id='cartAddBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Update'><input class='cartCancelBtn ProductBtn' id='cartCancelBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Cancel'>";
                         totalPrice = totalPrice + (value.quantity * value.price);
                        addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,qtyinput+" "+value.uOm__type,totalPriceBox,statusSpan,action]).draw();

                     });
                 }

            }else if(type == "productAdd"){
             if (myaddProductTableList.length > 0) {
                addProductTable.destroy();
                 $('#addProductTable').empty();
                 addProductTable.clear().draw();
                 addProductTable = $('#addProductTable').DataTable({
                    "bFilter": false,
                    "bLengthChange": false,
                    "pageLength": -1,
                    "targets": 'no-sort',
                    "bSort": false,
                    "info": false,
                    "searching": true,
                    "order": [],
                    "pagingType": "full_numbers",
                    language: {
                            paginate: {
                                previous: false,
                                next: false,
                                first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                                last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                            }
                    },
                    "columns": [
                            { "title": "S.No" },
                            { "title": "Product Code" },
                            { "title": "Product Name"},
                            { "title": "Category"},
                            { "title": "Price"},
                            { "title": "UOM"},
                            { "title": "Qty"},
                            { "title": "Total"},
                            { "title": "Other Vendors"},
                            { "title": "Vendor Name"},
                            { "title": "Status"},
                            { "title": "Action"}

                        ],
                        columnDefs: [
                             { "width": "2%", "targets": 0 },
                             { "width": "10%", "targets": 1 },
                             { "width": "10%", "targets": 2 },
                             { "width": "10%", "targets": 3 },
                             { "width": "10%", "targets": 4 },
                             { "width": "5%", "targets": 5 },
                             { "width": "10%", "targets": 6 },
                             { "width": "10%", "targets": 7 },
                             { "width": "8%", "targets": 8 },
                             { "width": "8%", "targets": 9 },
                             { "width": "5%", "targets": 10 },
                             { "width": "10%", "targets": 11 },

                        ],
                    responsive: {
                        details: {
                            renderer: $.fn.dataTable.Responsive.renderer.tableAll()
                        }
                    }

                 });
                 if(supData != 'Single'){
                    addProductTable.columns(8).visible(true);
                 }
                 else{
                    addProductTable.column(8).visible(false);
                 }
                 $.each(addProductTableListData, function( index, value ) {
                    if (value.hasOwnProperty('quantity')) {
                        var sno = index+1;
                        var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' value='"+value.quantity+"' id='qtytextbox"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='text'>";
                        var statusSpan = "<span name='statusbox"+value.id+"' id='statusbox"+value.id+"'>Added</span>";
                        var totalVal = value.quantity * value.price;
                        var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                        var totalPriceBox = "<span id='totalPriceBox"+value.id+"'>"+totalValData+" "+value.priceUnit__type+"</span>";
                        var action = "<input class='cartCancelBtn ProductBtn' id='cartCancelBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Cancel'>";
                        var itemSubArr = value.itemSup;
                         if($(itemSubArr).toArray().length >= 1){
                            var otherSupList = "<select class='otherSupplierList' id='otherSupplier_"+value.itemCode+"'></select>";
                            addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,value.uOm__type,qtyinput,totalPriceBox,otherSupList,value.supplierId__supCompanyName,statusSpan,action]).draw();
                             var osAppendValues = "<option value=''>Select</option>";
                             $.each(value.itemSup, function( index, value ) {
                                osAppendValues = osAppendValues + "<option value="+value.supplierId+">"+value.supplierId__supCompanyName+"</option>";
                             });
                             $('#otherSupplier_'+value.itemCode).empty().append(osAppendValues);
                         }
                         else{
                            var otherSupList = '';
                            addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,value.uOm__type,qtyinput,totalPriceBox,otherSupList,value.supplierId__supCompanyName,statusSpan,action]).draw();
                         }
                    }
                    else {
                        var sno = index+1;
                        if (value.hasOwnProperty('quantitys')) {
                            var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' value='"+value.quantitys+"' id='qtytextbox"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='text'>";
                            var totalVal = value.quantitys*value.price;
                            var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                            var totalPriceBox = "<span id='totalPriceBox"+value.id+"'>"+totalValData+" "+value.priceUnit__type+"</span>";
                        }
                        else{
                            var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' id='qtytextbox"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='text'>";
                            var totalPriceBox = "<span id='totalPriceBox"+value.id+"'></span>";
                        }
                        var statusSpan = "<span name='statusbox"+value.id+"' id='statusbox"+value.id+"'></span>";
                        var action = "<input class='cartCancelBtn ProductBtn' id='cartCancelBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Cancel'>";
                        var itemSubArr = value.itemSup;
                         if($(itemSubArr).toArray().length >= 1){
                            var otherSupList = "<select class='otherSupplierList' id='otherSupplier_"+value.itemCode+"'></select>";
                            addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,value.uOm__type,qtyinput,totalPriceBox,otherSupList,value.supplierId__supCompanyName,statusSpan,action]).draw();
                             var osAppendValues = "<option value=''>Select</option>";
                             $.each(value.itemSup, function( index, value ) {
                                osAppendValues = osAppendValues + "<option value="+value.supplierId+">"+value.supplierId__supCompanyName+"</option>";
                             });
                             $('#otherSupplier_'+value.itemCode).empty().append(osAppendValues);
                         }
                         else{
                            var otherSupList = '';
                            addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,value.uOm__type,qtyinput,totalPriceBox,otherSupList,value.supplierId__supCompanyName,statusSpan,action]).draw();
                         }
                    }
                 });
                 $('#addProductTable').DataTable().page.len(10).draw();
                 addProductTable.page( pageNo ).draw( 'page' );
             }
             else {
             addProductTable.destroy();
                 $('#addProductTable').empty();
                 addProductTable.clear().draw();
               addProductTable = $('#addProductTable').DataTable({
                    "bFilter": false,
                    "bLengthChange": false,
                    "pageLength": -1,
                    "targets": 'no-sort',
                    "bSort": false,
                    "info": false,
                    "searching": true,
                    "order": [],
                    "pagingType": "full_numbers",
                    language: {
                            paginate: {
                                previous: false,
                                next: false,
                                first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                                last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                            }
                    },
                     "columns": [
                            { "title": "S.No" },
                            { "title": "Product Code" },
                            { "title": "Product Name"},
                            { "title": "Category"},
                            { "title": "Price"},
                            { "title": "UOM"},
                            { "title": "Qty"},
                            { "title": "Total"},
                            { "title": "Other Vendors"},
                            { "title": "Vendor Name"},
                            { "title": "Status"},
                            { "title": "Action"}

                        ],
                        columnDefs: [
                             { "width": "2%", "targets": 0 },
                             { "width": "10%", "targets": 1 },
                             { "width": "10%", "targets": 2 },
                             { "width": "10%", "targets": 3 },
                             { "width": "10%", "targets": 4 },
                             { "width": "5%", "targets": 5 },
                             { "width": "10%", "targets": 6 },
                             { "width": "10%", "targets": 7 },
                             { "width": "8%", "targets": 8 },
                             { "width": "8%", "targets": 9 },
                             { "width": "5%", "targets": 10 },
                             { "width": "10%", "targets": 11 },

                        ],
                    responsive: {
                        details: {
                            renderer: $.fn.dataTable.Responsive.renderer.tableAll()
                        }
                    }

                 } );

                 if(supData != 'Single'){
                    addProductTable.columns(8).visible(true);
                 }
                 else{
                    addProductTable.column(8).visible(false);
                 }

                $.each(addProductTableListData, function( index, value ) {
                    var sno = index+1;
                    var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' id='qtytextbox"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='text'>";
                    var statusSpan = "<span name='statusbox"+value.id+"' id='statusbox"+value.id+"'></span>";
                    var totalPriceBox = "<span id='totalPriceBox"+value.id+"'></span>";
                    var action = "<input class='cartCancelBtn ProductBtn' id='cartCancelBtn"+value.id+"_"+value.price+"_"+value.priceUnit__type+"' type='button' value='Cancel'>";
                    var itemSubArr = value.itemSup;
                 if($(itemSubArr).toArray().length >= 1){
                    var otherSupList = "<select class='otherSupplierList' id='otherSupplier_"+value.itemCode+"'></select>";
                    addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,value.uOm__type,qtyinput,totalPriceBox,otherSupList,value.supplierId__supCompanyName,statusSpan,action]).draw();
                     var osAppendValues = "<option value=''>Select</option>";
                     $.each(value.itemSup, function( index, value ) {
                        osAppendValues = osAppendValues + "<option value="+value.supplierId+">"+value.supplierId__supCompanyName+"</option>";
                     });
                     $('#otherSupplier_'+value.itemCode).empty().append(osAppendValues);
                 }
                 else{
                    var otherSupList = '';
                    addProductTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.price+" "+value.priceUnit__type,value.uOm__type,qtyinput,totalPriceBox,otherSupList,value.supplierId__supCompanyName,statusSpan,action]).draw();
                 }

                 });
                 addProductTable.columns([4]).visible(false);
                 $('#addProductTable').DataTable().page.len(10).draw();
                 addProductTable.page( pageNo ).draw( 'page' );
             }
            }

           }

        function disableSuppliers(status) {
            $('#chooseSupplierSelectbox').attr("disabled", status);
            $('#selectSupplierSelectbox').attr("disabled", status);
        }

        $(document).on('click', '.orderSubLi', function() {
        if(addProductTableList.length > 0 ){
            if ($(this).attr('id') == 'placeOrderTabOne' || $(this).attr('id') == 'placeOrderTabTwo') {
            $("#placeOrderTabSix").prop('disabled', true);
            $("#circle4").prop('disabled', true);
                    $('#placeOrderDiv').hide();
                    $('#deliverDataDiv').show();
                    $('.orderSubLi').removeClass('orderSubLiActive');
                    $('#placeOrderTabOne').addClass('orderSubLiActive');
                    $('#placeOrderTabTwo').addClass('orderSubLiActive');
                    $('.containern').removeClass('activeLine');
                    $("#dropselect2L").addClass('activeLine');
                    $('.circlenew').removeClass('activeCircle');
                    disableSuppliers(false);
            }
            else if ($(this).attr('id') == 'placeOrderTabThree') {
            $("#placeOrderTabFive").prop('disabled', true);
            $("#placeOrderTabSix").prop('disabled', true);
            $("#circle3").prop('disabled', true);
            $("#circle4").prop('disabled', true);
                if ($('#chooseSupplierSelectbox').val() == 'Multiple' && $('#deliveryAddress').val() != '' && $('#deliveryDate').val() != null) {
                    $('.orderSubLi').removeClass('orderSubLiActive');
                    $('#'+$(this).attr('id')+'').addClass('orderSubLiActive');
                    $('#deliverDataDiv').hide();
                    $('#placeOrderDiv').show();
                    $("#processBtnDiv").html(reviewBtn);
                    disableSuppliers(true);
                    $('.addToCartClass').show();
                    addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabThree');
                    addRemoveDisabledInFilter('#f8f1f1', false);
                    if(addToCartPushData){
                        for( var i=addProductTableList.length - 1; i>=0; i--){
                            for( var j=0; j<addToCartPushData.length; j++){
                                if(addProductTableList[i] && (addProductTableList[i].id === addToCartPushData[j].id)){
                                    addProductTableList.splice(i, 1);
                                }
                            }
                        }
                            addProductTableList = arrayUnique(addToCartPushData.concat(addProductTableList));
                        }
                        else{
                            addProductTableList = addProductTableList;
                        }
                    pullProductTable(addProductTableList,"productAdd");
                }
                else if ($('#chooseSupplierSelectbox').val() == 'Single' && $('#selectSupplierSelectbox').val() != 'Select'  && $('#deliveryAddress').val() != '' && $('#deliveryDate').val() != null) {
                    $('.orderSubLi').removeClass('orderSubLiActive');
                    $('#'+$(this).attr('id')+'').addClass('orderSubLiActive');
                    $('#deliverDataDiv').hide();
                    $('#placeOrderDiv').show();
                    $("#processBtnDiv").html(reviewBtn);
                    disableSuppliers(true);
                    $('.addToCartClass').show();
                    addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabThree');
                    addRemoveDisabledInFilter('#f8f1f1', false);
                    pullProductTable(addProductTableList,"productAdd");
                }
                else if ($('#chooseSupplierSelectbox').val() == 'Single' && $('#selectSupplierSelectbox').val() == 'Select' && $('#deliveryAddress').val() != '' && $('#deliveryDate').val() != null) {
                    alert('Please select vendor');
                }
                else {
                    alert("You are missed either location or delivery date. Please choose corresponding field.");
                }
            }
            else if ($(this).attr('id') == 'placeOrderTabFour') {
            $("#placeOrderTabFive").prop('disabled', false);
            $("#placeOrderTabSix").prop('disabled', true);
            $("#circle3").prop('disabled', false);
            $("#circle4").prop('disabled', true);
                if(myaddProductTableList.length == 0){
                  alert("You should add product first! ");
                } else {
                myaddProductTableList = removeDuplicates(myaddProductTableList, 'id','supplierId__supCompanyName');
                        function removeDuplicates(originalArray, objKey, objKey1) {
                          var trimmedArray = [];
                          var values = [];
                          var value;

                          for(var i = 0; i < originalArray.length; i++) {
                            value = originalArray[i][objKey];
                            value1 = originalArray[i][objKey1];

                            if(values.indexOf(value) === -1 && values.indexOf(value1) === -1) {
                              trimmedArray.push(originalArray[i]);
                              values.push(value);
                            }
                          }

                          return trimmedArray;

                        }
                  $("#processBtnDiv").html(confirmBtn);
                      addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabFour');
                      addRemoveDisabledInFilter('#f8f1f1', true);
                      var deliveryDate = $("#deliveryDate").val();
                      var siteId = $("#deliveryAddress").val();
                      var today = new Date();
                      var dd = String(today.getDate()).padStart(2, '0');
                      var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
                      var yyyy = today.getFullYear();
                      var currentDate = dd + '/' + mm + '/' + yyyy;
                      var reviewData = new Object();
                      reviewData.siteId = $('#deliveryAddress').val();
                      reviewData.deliveryDate = $('#deliveryDate').val();
                      reviewData.currentDate = currentDate;
                      reviewData.data = myaddProductTableList;
                       $.ajax({
                          url: "/reviewOrderCheckSla",
                          type: "POST",
                          dataType : "json",
                          contentType : "application/json",
                          data: JSON.stringify(reviewData),
                          success: function (result)
                          {
                          if (result.status == 'success') {
                             var myaddProductTableList = result.totalItems;
                                pullProductTable(myaddProductTableList,"reviewOrder");
                            }
                            else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                                alert('Session has expired.');
                                setTimeout(function() {
                                    window.location.href = result.redirect_url;
                                }, 2000);

                            }else{
                            alert(result.error_msg);
                           }
                            }
                         });
                }
            }
            else if ($(this).attr('id') == 'placeOrderTabFive') {
                var status;
                     $.each(myaddProductTableList, function( index, value ) {
                         if (value.quantity != '' && value.quantity != 0) {
                            status = true;
                        }
                        else {
                            status = false;
                            return false;
                        }
                     });

                    if(status == true){
                    $("#placeOrderTabSix").prop('disabled', false);
                    $("#circle4").prop('disabled', false);
                    $("#processBtnDiv").html(submitBtn);
                    addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabFive');
                    addRemoveDisabledInFilter('#f8f1f1', true);
                    var deliveryDate = $("#deliveryDate").val();
                      var siteId = $("#deliveryAddress").val();
                      var today = new Date();
                      var dd = String(today.getDate()).padStart(2, '0');
                      var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
                      var yyyy = today.getFullYear();
                      var currentDate = dd + '/' + mm + '/' + yyyy;
                      var reviewData = new Object();
                      reviewData.siteId = $('#deliveryAddress').val();
                      reviewData.deliveryDate = $('#deliveryDate').val();
                      reviewData.currentDate = currentDate;
                      reviewData.data = myaddProductTableList;
                       $.ajax({
                          url: "/reviewOrderCheckSla",
                          type: "POST",
                          dataType : "json",
                          contentType : "application/json",
                          data: JSON.stringify(reviewData),
                          success: function (result)
                          {
                          if (result.status == 'success') {
                             var myaddProductTableList = result.totalItems;
                                pullProductTable(myaddProductTableList,"confirmOrder");
                            }
                            else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                                alert('Session has expired.');
                                setTimeout(function() {
                                    window.location.href = result.redirect_url;
                                }, 2000);

                            }else{
                            alert(result.error_msg);
                           }
                                }
                         });
                         }
                     else {
                          alert('Please enter a valid Qty');
                          return false;
                     }
            }
            else if ($(this).attr('id') == 'placeOrderTabSix') {
            $("#submitOrder").prop('disabled', true);
                    $("#circle4").prop('disabled', true);
                    //$("#placeOrderTabSix").prop('disabled', true);
                    if(myaddProductTableList.length == 0){
                      alert("You should add product first! ");
                      $("#submitOrder").prop('disabled', false);
                        $("#circle4").prop('disabled', false);
                        $("#placeOrderTabSix").prop('disabled', false);
                    } else {
                    $body.addClass("loading");
                    addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabSix');
                    addRemoveDisabledInFilter('#f8f1f1', true);
                    $('.addToCartClass').hide();
                    var orderData = new Object();
                    orderData.deliveryAddressId = $('#deliveryAddress').val();
                    orderData.deliveryDate = $('#deliveryDate').val();
                    orderData.expectedTime = $('#timeSlot').val();
                    orderData.totalPrice = totalPrice;
                    orderData.data = myaddProductTableList;
                    $.ajax({
                      url: "/orderPlacement",
                      type: "POST",
                      dataType : "json",
                      contentType : "application/json",
                      data: JSON.stringify(orderData),
                      success: function (result)
                      {
                         if (result.status == 'success') {
                         $body.removeClass("loading");
                         $('#deliverOrderDiv').css('display','none');
                         $('#placeOrderDiv').css('display','none');
                         alert(result.success_msg);
                                location.reload();
                        }
                        else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                            alert('Session has expired.');
                            setTimeout(function() {
                                window.location.href = data.redirect_url;
                            }, 2000);

                        }
                        else{
                            alert(result.error_msg);
                            $("#submitOrder").prop('disabled', false);
                            $("#circle4").prop('disabled', false);
                            $("#placeOrderTabSix").prop('disabled', false);
                        }
                      }
                    });
                }
            }
            }
            else{
                alert('No product found');
            }
        });

    $(document).on('click', '.orderProcessBtn', function() {
    if(addProductTableList.length > 0 ){
        var processBtnId = $(this).attr("id");
        if (processBtnId == 'placeOrder' || processBtnId == 'circle1') {
        $("#circle4").prop('disabled', true);
        $("#placeOrderTabSix").prop('disabled', true);
        $("#placeOrderTabFive").prop('disabled', true);
        $("#circle3").prop('disabled', true);
            if ($('#chooseSupplierSelectbox').val() == 'Multiple' && $('#deliveryAddress').val() != '' && $('#deliveryDate').val() != null) {
                $('.addToCartClass').show();
                $('#deliverDataDiv').hide();
                $('#placeOrderDiv').show();
                disableSuppliers(true);
                addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabThree');
                addRemoveDisabledInFilter('#fff7d0', false);
                $("#processBtnDiv").html(reviewBtn);
                if(addToCartPushData){
                for( var i=addProductTableList.length - 1; i>=0; i--){
                    for( var j=0; j<addToCartPushData.length; j++){
                        if(addProductTableList[i] && (addProductTableList[i].id === addToCartPushData[j].id)){
                            addProductTableList.splice(i, 1);
                        }
                    }
                }
                    addProductTableList = arrayUnique(addToCartPushData.concat(addProductTableList));
                }
                else{
                    addProductTableList = addProductTableList;
                }
                pullProductTable(addProductTableList,"productAdd");
            }
            else if ($('#chooseSupplierSelectbox').val() == 'Single' && $('#selectSupplierSelectbox').val() != 'Select' && $('#deliveryAddress').val() != '' && $('#deliveryDate').val() != null) {
                $('.addToCartClass').show();
                $('#deliverDataDiv').hide();
                $('#placeOrderDiv').show();
                disableSuppliers(true);
                addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabThree');
                addRemoveDisabledInFilter('#fff7d0', false);
                $("#processBtnDiv").html(reviewBtn);
                pullProductTable(addProductTableList,"productAdd");
            }
            else if ($('#chooseSupplierSelectbox').val() == 'Single' && $('#selectSupplierSelectbox').val() == 'Select' && $('#deliveryAddress').val() != '' && $('#deliveryDate').val() != null) {
                alert('Please select vendor');
            }
            else {
                alert('You are missed either location or delivery date. Please choose corresponding field.');
            }
        }
        else {
            if(myaddProductTableList.length == 0){
              alert("You should add product first! ");
            }
             else {
                $('.addToCartClass').hide();
                if(processBtnId == "reviewOrder" || processBtnId == 'circle2') {
                if(addToCartPushData){
                    myaddProductTableList = arrayUnique(addToCartPushData.concat(myaddProductTableList));
                    myaddProductTableList = removeDuplicates(myaddProductTableList, 'id','supplierId__supCompanyName');
                        function removeDuplicates(originalArray, objKey, objKey1) {
                          var trimmedArray = [];
                          var values = [];
                          var value;
                          var value1;

                          for(var i = 0; i < originalArray.length; i++) {
                            value = originalArray[i][objKey];
                            value1 = originalArray[i][objKey1];

                            if(values.indexOf(value) === -1 && values.indexOf(value1) === -1) {
                              trimmedArray.push(originalArray[i]);
                              values.push(value);
                            }
                          }

                          return trimmedArray;

                        }
                    }
                else{
                    myaddProductTableList = myaddProductTableList;
                }
                $("#placeOrderTabFive").prop('disabled', false);
                $("#circle3").prop('disabled', false);
                $("#circle4").prop('disabled', true);
                $("#placeOrderTabSix").prop('disabled', true);
                  $("#processBtnDiv").html(confirmBtn);
                  addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabFour');
                  addRemoveDisabledInFilter('#f8f1f1', true);
                  var deliveryDate = $("#deliveryDate").val();
                  var siteId = $("#deliveryAddress").val();
                  var today = new Date();
                  var dd = String(today.getDate()).padStart(2, '0');
                  var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
                  var yyyy = today.getFullYear();
                  var currentDate = dd + '/' + mm + '/' + yyyy;
                  var reviewData = new Object();
                  reviewData.siteId = $('#deliveryAddress').val();
                  reviewData.deliveryDate = $('#deliveryDate').val();
                  reviewData.currentDate = currentDate;
                  reviewData.data = myaddProductTableList;
                   $.ajax({
                      url: "/reviewOrderCheckSla",
                      type: "POST",
                      dataType : "json",
                      contentType : "application/json",
                      data: JSON.stringify(reviewData),
                      success: function (result)
                      {
                      if (result.status == 'success') {
                         var myaddProductTableList = result.totalItems;
                            pullProductTable(myaddProductTableList,"reviewOrder");
                        }
                        else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                            alert('Session has expired.');
                            setTimeout(function() {
                                window.location.href = result.redirect_url;
                            }, 2000);

                        }else{
                        alert(result.error_msg);
                       }
                        }
                     });

                    }
                    else if(processBtnId == "confirmOrder" || processBtnId == 'circle3') {
                    $("#circle4").prop('disabled', false);
                    $("#placeOrderTabSix").prop('disabled', false);
                    var status;
                     $.each(myaddProductTableList, function( index, value ) {
                         if (value.quantity != '' && value.quantity != 0) {
                            status = true;
                        }
                        else {
                            status = false;
                            return false;
                        }
                     });

                     if(status == true){
                     myaddProductTableList = removeDuplicates(myaddProductTableList, 'id','supplierId__supCompanyName');
                        function removeDuplicates(originalArray, objKey, objKey1) {
                          var trimmedArray = [];
                          var values = [];
                          var value;

                          for(var i = 0; i < originalArray.length; i++) {
                            value = originalArray[i][objKey];
                            value1 = originalArray[i][objKey1];

                            if(values.indexOf(value) === -1 && values.indexOf(value1) === -1) {
                              trimmedArray.push(originalArray[i]);
                              values.push(value);
                            }
                          }

                          return trimmedArray;

                        }
                    $("#processBtnDiv").html(submitBtn);
                    addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabFive');
                    addRemoveDisabledInFilter('#f8f1f1', true);
                    var deliveryDate = $("#deliveryDate").val();
                  var siteId = $("#deliveryAddress").val();
                  var today = new Date();
                  var dd = String(today.getDate()).padStart(2, '0');
                  var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
                  var yyyy = today.getFullYear();
                  var currentDate = dd + '/' + mm + '/' + yyyy;
                  var reviewData = new Object();
                  reviewData.siteId = $('#deliveryAddress').val();
                  reviewData.deliveryDate = $('#deliveryDate').val();
                  reviewData.currentDate = currentDate;
                  reviewData.data = myaddProductTableList;
                   $.ajax({
                      url: "/reviewOrderCheckSla",
                      type: "POST",
                      dataType : "json",
                      contentType : "application/json",
                      data: JSON.stringify(reviewData),
                      success: function (result)
                      {
                      if (result.status == 'success') {
                         var myaddProductTableList = result.totalItems;
                            pullProductTable(myaddProductTableList,"confirmOrder");
                        }
                        else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                            alert('Session has expired.');
                            setTimeout(function() {
                                window.location.href = result.redirect_url;
                            }, 2000);

                        }else{
                        alert(result.error_msg);
                       }
                            }
                     });
                     }
                     else {
                     alert('Please enter a valid Qty');
                            return false;
                        }
                }
                else if(processBtnId == "submitOrder" || processBtnId == 'circle4') {
                $("#submitOrder").prop('disabled', true);
                $("#circle4").prop('disabled', true);
                $("#placeOrderTabSix").prop('disabled', true);
                var status;
                     $.each(myaddProductTableList, function( index, value ) {
                         if (value.quantity != '' && value.quantity != 0) {
                            status = true;
                        }
                        else {
                            status = false;
                            return false;
                        }
                     });
                 if(status == true){
                 $body.addClass("loading");
                    addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabSix');
                    addRemoveDisabledInFilter('#f8f1f1', true);
                    var orderData = new Object();
                    var deliveryDate = $("#deliveryDate").val();
                    var supData = $("#chooseSupplierSelectbox").val();
                  var siteId = $("#deliveryAddress").val();
                  var today = new Date();
                  var dd = String(today.getDate()).padStart(2, '0');
                  var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
                  var yyyy = today.getFullYear();
                  var currentDate = dd + '/' + mm + '/' + yyyy;
                  var reviewData = new Object();
                  reviewData.siteId = $('#deliveryAddress').val();
                  reviewData.deliveryDate = $('#deliveryDate').val();
                  reviewData.currentDate = currentDate;
                  reviewData.data = myaddProductTableList;
                  if(supData != 'Single'){
                   $.ajax({
                      url: "/reviewOrderCheckSla",
                      type: "POST",
                      dataType : "json",
                      contentType : "application/json",
                      data: JSON.stringify(reviewData),
                      success: function (result)
                      {
                      if (result.status == 'success') {
                         var myaddProductTableList = result.totalItems;
                         orderData.deliveryAddressId = $('#deliveryAddress').val();
                        orderData.deliveryDate = $('#deliveryDate').val();
                        orderData.expectedTime = $('#timeSlot').val();
                        orderData.totalPrice = totalPrice;

                        orderData.data = myaddProductTableList;

                         $.ajax({
                          url: "/orderPlacement",
                          type: "POST",
                          dataType : "json",
                          contentType : "application/json",
                          data: JSON.stringify(orderData),
                          success: function (result)
                          {
                          $body.removeClass("loading");
                             if (result.status == 'success') {
                             $('#deliverOrderDiv').css('display','none');
                             $('#placeOrderDiv').css('display','none');
                             alert(result.success_msg);
                             location.reload();
                            }
                            else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                                alert('Session has expired.');
                                setTimeout(function() {
                                    window.location.href = data.redirect_url;
                                }, 2000);
                            }
                            else{
                                alert(result.error_msg);
                                $("#submitOrder").prop('disabled', false);
                                $("#circle4").prop('disabled', false);
                                $("#placeOrderTabSix").prop('disabled', false);
                            }
                          }
                        });
                        }
                        }
                     });
                     }

                     else{
                        orderData.deliveryAddressId = $('#deliveryAddress').val();
                        orderData.deliveryDate = $('#deliveryDate').val();
                        orderData.expectedTime = $('#timeSlot').val();
                        orderData.totalPrice = totalPrice;
                        orderData.data = myaddProductTableList;
                           $.ajax({
                          url: "/orderPlacement",
                          type: "POST",
                          dataType : "json",
                          contentType : "application/json",
                          data: JSON.stringify(orderData),
                          success: function (result)
                          {
                             if (result.status == 'success') {
                             $('#deliverOrderDiv').css('display','none');
                             $('#placeOrderDiv').css('display','none');
                             alert(result.success_msg);
                             location.reload();
                            }
                            else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                                alert('Session has expired.');
                                setTimeout(function() {
                                    window.location.href = data.redirect_url;
                                }, 2000);
                            }
                            else{
                                alert(result.error_msg);
                                $("#submitOrder").prop('disabled', false);
                                $("#circle4").prop('disabled', false);
                                $("#placeOrderTabSix").prop('disabled', false);
                            }
                          }
                        });
                     }

                }

             else {
             alert('Please enter a valid Qty');
             $("#submitOrder").prop('disabled', false);
                $("#circle4").prop('disabled', false);
                $("#placeOrderTabSix").prop('disabled', false);
                    return false;
                }
            }
            }
        }
        }
        else{
            alert('No product found');
        }
    });

    function addActiveClass(tabClass, tabClassActive, activeTabId) {
        $('.'+tabClass+'').removeClass(tabClassActive);
        $('#'+activeTabId+'').addClass(tabClassActive);
        if (activeTabId == 'placeOrderTabThree') {
            $('.containern').removeClass('activeLine');
            $("#dropselect1L, #circle01L").addClass('activeLine');
            $('.circlenew').removeClass('activeCircle');
            $("#circle1").addClass('activeCircle');
        }
        else if (activeTabId == 'placeOrderTabFour') {
            $('.containern').removeClass('activeLine');
            $("#dropselect1L, #circle01L, #circle1L, #circle02L").addClass('activeLine');
            $('.circlenew').removeClass('activeCircle');
            $("#circle2").addClass('activeCircle');
        }
        else if (activeTabId == 'placeOrderTabFive') {
            $('.containern').removeClass('activeLine');
            $("#dropselect1L, #circle01L, #circle1L, #circle02L, #circle2L,#circle03L").addClass('activeLine');
            $('.circlenew').removeClass('activeCircle');
            $("#circle3").addClass('activeCircle');
        }
        else if (activeTabId == 'placeOrderTabSix') {
            $('.containern').removeClass('activeLine');
            $("#dropselect1L, #circle01L, #circle1L, #circle02L, #circle2L,#circle03L,#circle3L,#circle04L").addClass('activeLine');
            $('.circlenew').removeClass('activeCircle');
            $("#circle4").addClass('activeCircle');
        }
    }

    $(document).on('change', '#showprice', function() {
        if(this.checked) {
            alert('Checked');
        }
        else{
            alert('Un Checked');
        }
    });

 $(document).on('change', '.select_catsub', function() {
        var catVal = $('#select_category').val();
        var supVal = $('#select_suppliers').val();
        var catsup = new Object();
        var cat = new Array();
        var sup = new Array();
        var type = "customer";
         if(catVal != "Category"){
             cat.push(catVal);
           }

         if(supVal != ""){
             sup.push(supVal);
           }

        catsup.cat = cat;
        catsup.sup = sup;
        catsup.type = type;
         $.ajax({
              url: "/listOfItemsSupplierOrCustomer",
              type: "POST",
              dataType : "json",
              contentType : "application/json",
              data: JSON.stringify(catsup),
              success: function (result)
              {
                if (result.status == 'success') {
                    addProductTableList = result.totalItems[0].totalItem;
                    var array3;
                    if(addToCartPushData){
                    for( var i=addProductTableList.length - 1; i>=0; i--){
                        for( var j=0; j<addToCartPushData.length; j++){
                            if(addProductTableList[i] && (addProductTableList[i].id === addToCartPushData[j].id)){
                                addProductTableList.splice(i, 1);
                            }
                        }
                    }
                    $.each(addProductTableList, function(i, val) {
                        $.each(val, function(key, name) {
                            if (name === "itemSup"){
                                if(addProductTableList.itemSup.supplierId==supVal){
                                    addProductTableList.itemSup.splice(k,1);
                                }
                            }
                        });
                    });

                     $.each(addToCartPushData, function(i, val) {
                        $.each(val, function(key, name) {
                            if (name === "itemSup"){
                                if(addToCartPushData.itemSup.supplierId==supVal){
                                    addToCartPushData.itemSup.splice(k,1);
                                }
                            }
                        });
                    });
                    array3 = arrayUnique(addToCartPushData.concat(addProductTableList));
                    }
                    else{
                        array3 = addProductTableList;
                    }
                    addProductTableList = array3;
                    pullProductTable(addProductTableList,"productAdd");
                }
                else if(result.status == 'error' && result.error_msg == 'sessionexpired'){
                         alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);

                    }
                else{
                    alert(result.error_msg);
                    addProductTableList = [];
                    pullProductTable(addProductTableList,"productAdd");
                }
              }
         });
    });

function arrayUnique(array) {
    var a = array.concat();
    for(var i=0; i<a.length; ++i) {
        for(var j=i+1; j<a.length; ++j) {
            if(a[i] === a[j])
                a.splice(j--, 1);
        }
    }

    return a;
}

var addToCartPushData ;
myaddProductTableList = [];
    $(document).on('click',	'.addToCartClass', function() {
        var counter = 0;
        if(addToCartPushData){
            /*for( var i=myaddProductTableList.length - 1; i>=0; i--){
                for( var j=0; j<addToCartPushData.length; j++){
                    if(myaddProductTableList[i] && (myaddProductTableList[i].id === addToCartPushData[j].id)){
                        myaddProductTableList.splice(i, 1);
                    }
                }
            }*/
            myaddProductTableList = arrayUnique(addToCartPushData.concat(myaddProductTableList));
        }
        else{
            myaddProductTableList = [];
        }
        addProductTable.$('.qtytextbox').each(function() {
         var idNum = addProductTable.$(this).attr('id').replace(/^\D+/g, '');
            var res = idNum.split('_');
            var name = addProductTable.$(this).attr('name');
            if ($("input[name="+name+"]").val() != '' && $("input[name="+name+"]").val() != 0) {
                var qtytextboxVal = document.getElementById($(this).attr('id')).value;
                var totalVal = qtytextboxVal*res[1];
                var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                var itemD = new Object();
                itemD = $.grep(addProductTableList, function(el) {
                    return el.id == res[0];
                });
                itemD[0].quantity = qtytextboxVal;
                myaddProductTableList.push(itemD[0]);
                addToCartPushData = myaddProductTableList;
                $("#statusbox"+res[0]).html('Added');
                $("#totalPriceBox"+res[0]).html(totalValData+" "+res[2]);
                counter++;
            }
        });
        if (counter > 0) {
            alert('Product Added successfully!');
        }
        else {
            addRemoveDisabledInFilter('#fff7d0', false);
            alert("You should add product first!");
        }
    });

var info = addProductTable.page.info();
var pageNo = info.page;

$('#addProductTable').on( 'page.dt', function () {
    var notAdded = [];
    addProductTable.$('.qtytextbox').each(function() {
         var idNum = addProductTable.$(this).attr('id').replace(/^\D+/g, '');
            var res = idNum.split('_');
            var name = addProductTable.$(this).attr('name');
            if ($("input[name="+name+"]").val()) {
                if($("#statusbox"+res[0]).text()==''){
                    notAdded.push('false');
                }
                else{
                    notAdded.push('true');
                }
            }
            else{
                notAdded.push('true');
            }
        });
        if(notAdded.includes("false") == true){
            alert('Please add the selected products to the cart and proceed further!!');
            addProductTable.page(pageNo);
        }
        else{
            info = addProductTable.page.info();
            pageNo = info.page;
        }

    });

    var indexing = 0;

    $('#addProductTable').on('click', 'tbody .otherSupplierList', function (e) {
        indexing = addProductTable.row($(this).closest('tr')).index();
    });

    $('#addProductTable').on('change', 'tbody .otherSupplierList', function (e) {
        var id = $(this).attr('id');
        var resIdData = id.split('_');
        var resIdDataId = resIdData[1];
        var supId = $('#'+id).val();
        $("#"+id+" option:selected").remove();
        var length = $("#"+id +"> option").length;
        if(length == 1){
            $("#"+id).remove();
        }
        var itemD = new Object();

        for(var j = 0; j < addProductTableList[indexing].itemSup.length; j++){
            if(addProductTableList[indexing].itemSup[j].supplierId==supId){
            addProductTableList[indexing].itemSup.splice(j,1);
            break
            }
        }

 var arrData = {"itemCode":id.split('_')[1],"supplierId":supId};
         $.ajax({
                  url: "/listOfItemByitemCodeAndSupplierId",
                  type: "POST",
                  dataType : "json",
                  contentType : "application/json",
                  data: JSON.stringify(arrData),
                  success: function (result)
                  {
                    if (result.status == 'success') {
                        otherSupList = result.totalItems[0].totalItem;
                        addProductTableList.splice(indexing+1, 0, otherSupList[0]);
                        pullProductTable(addProductTableList,"productAdd");
                    }
                  }
               });

        //myaddProductTableList = [];
        addProductTable.$('.qtytextbox').each(function() {
        var name = addProductTable.$(this).attr('name');
            if ($("input[name="+name+"]").val() != '' && $("input[name="+name+"]").val() != 0) {
                var idNum = addProductTable.$(this).attr('id').replace(/^\D+/g, '');
                var res = idNum.split('_');
                var qtytextboxVal = document.getElementById($(this).attr('id')).value;
                var totalVal = qtytextboxVal*res[1];
                var totalValData = parseFloat(Math.round(totalVal * 100) / 100).toFixed(2);
                var itemD = new Object();
                itemD = $.grep(addProductTableList, function(el) {
                    return el.id == res[0];
                });
                itemD[0].quantitys = qtytextboxVal;
                myaddProductTableList.push(itemD[0]);
            }
        });
    });

    $(document).on('click',	'input.ProductBtn', function() {
            var idName = $(this).attr('id');
            var idNum = idName.replace(/^\D+/g, '');
             var res = idNum.split('_');
            var name = idName.replace(/\d+/g, '');
             var resName = name.split('_');
            var procesState = $("#processBtnDiv").find("a")[0].id;
            var qtytextboxVal = $("#qtytextbox"+idNum).val();
            var statusVal = $("#statusbox"+res[0]).html();
            var totalVal = qtytextboxVal*res[1];
            if(resName[0] == "cartAddBtn"){
                if(statusVal == ""){
                    if(qtytextboxVal != "" && parseFloat(qtytextboxVal) > 0){
                        $("#statusbox"+res[0]).html("Added");
                        var itemD = new Object();
                        itemD = $.grep(addProductTableList, function(el) {
                            return el.id == res[0];
                        });
                        itemD[0].quantity = qtytextboxVal;
                        myaddProductTableList.push(itemD[0]);

                        addRemoveDisabledInFilter('#f8f1f1', true);

                         $("#cartAddBtn"+idNum).val("Update");
                       }
                       else if(qtytextboxVal == ""){
                           alert("Quantity field should not empty!");
                       }
                       else if(qtytextboxVal == "."){
                           alert("Enter valid quantity");
                       }
                       else if(parseFloat(qtytextboxVal) == 0){
                           alert("Quantity field should not be zero!");
                       }
                       else if(qtytextboxVal[qtytextboxVal.length-1] == '.'){
                            alert("Enter valid quantity");
                        }
                    }
                    else {
                        for (var index in myaddProductTableList) {
                        if(myaddProductTableList[index].id == res[0]){
                            myaddProductTableList[index].quantity = qtytextboxVal;
                            if(qtytextboxVal != "" && parseFloat(qtytextboxVal) > 0){
                            $("#totalPriceBox"+res[0]).html(totalVal+" "+res[2]);
                                  alert("Updated successfully");
                              }
                            else if(qtytextboxVal == ""){
                                alert("Quantity field should not empty!");
                            }
                            else if(qtytextboxVal == "."){
                                 alert("Enter valid quantity");
                            }
                            else if(parseFloat(qtytextboxVal) == 0){
                               alert("Quantity field should not be zero!");
                            }

                        }
                    }
                }
            }
            else if(resName[0] == "cartCancelBtn"){
              if(statusVal == ""){
                $("#totalPriceBox"+res[0]).html("");
                $("#otherSupplier_"+res[0]).html("");
                $("#qtytextbox"+idNum).val("");
              }else {
                var itemD = $.grep(myaddProductTableList, function(el) {
                    return el.id == res[0];
                });
                myaddProductTableList.splice($.inArray(itemD[0], myaddProductTableList),1);
                var itemA = $.grep(addProductTableList, function(el) {
                    return el.id == res[0];
                });
              delete itemD[0]['quantity'];
              delete itemA[0]['quantitys'];
              addToCartPushData = myaddProductTableList;
              if (myaddProductTableList.length == 0) {
                addRemoveDisabledInFilter('#fff7d0', false);
                $('#deliverDataDiv').hide();
                $('#placeOrderDiv').show();
                $("#processBtnDiv").html(reviewBtn);
                $('.addToCartClass').show();
                addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabThree');
                pullProductTable(addProductTableList,"productAdd");
                $("#totalPriceBox"+res[0]).html("");
                $("#otherSupplier_"+res[0]).html("");
                 $("#qtytextbox"+idNum).val("");
                alert("Product cancelled successfully");
              }
              else{
                   $("#cartAddBtn"+idNum).val("Add");
                   $("#statusbox"+res[0]).html("");
                   $("#totalPriceBox"+res[0]).html("");
                   $("#otherSupplier_"+res[0]).html("");
                   pullProductTable(addProductTableList,"productAdd");
                   if(procesState == "confirmOrder"){
                      pullProductTable(myaddProductTableList,"reviewOrder");
                   }
                   $("#qtytextbox"+idNum).val("");
                   alert("Product cancelled successfully");

              }
            }
        }
    });

$(document).on('click',	'input.ProductBtnr', function() {
        var idName = $(this).attr('id');
        var idNum = idName.replace(/^\D+/g, '');
         var res = idNum.split('_');
        var name = idName.replace(/\d+/g, '');
         var resName = name.split('_');
        var procesState = $("#processBtnDiv").find("a")[0].id;
        var qtytextboxVal = $("#qtytextbox"+idNum).val();
        var statusVal = $("#statusbox"+res[0]).html();
        var totalVal = qtytextboxVal*res[1];

          var itemD = $.grep(myaddProductTableList, function(el) {
                return el.id == res[0];
            });
          myaddProductTableList.splice($.inArray(itemD[0], myaddProductTableList),1);

          var itemA = $.grep(addProductTableList, function(el) {
            return el.id == res[0];
          });
          delete itemA[0]['quantity'];
          delete itemA[0]['quantitys'];
          if (myaddProductTableList.length == 0) {
            addRemoveDisabledInFilter('#fff7d0', false);
            $('#deliverDataDiv').hide();
            $('#placeOrderDiv').show();
            $("#processBtnDiv").html(reviewBtn);
            $('.addToCartClass').show();
            addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabThree');
            pullProductTable(addProductTableList,"productAdd");
            $("#totalPriceBox"+res[0]).html("");
            var workTr = $(this).closest("tr");
               workTr.remove();
            alert("Product cancelled successfully");
          }
          else{
               $("#cartAddBtn"+idNum).val("Add");
               $("#statusbox"+res[0]).html("");
               $("#qtytextbox"+idNum).val("");
               $("#totalPriceBox"+res[0]).html("");
               if(procesState == "confirmOrder"){
                  pullProductTable(myaddProductTableList,"reviewOrder");
               }
               var row = this.closest('tr');
               addProductTable.row(row).remove().draw(false);
               $("#processBtnDiv").html(confirmBtn);
              addActiveClass('ordersubLi','orderSubLiActive','placeOrderTabFour');
              addRemoveDisabledInFilter('#f8f1f1', true);
              var deliveryDate = $("#deliveryDate").val();
              var siteId = $("#deliveryAddress").val();
              var today = new Date();
              var dd = String(today.getDate()).padStart(2, '0');
              var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
              var yyyy = today.getFullYear();
              var currentDate = dd + '/' + mm + '/' + yyyy;
              var reviewData = new Object();
              reviewData.siteId = $('#deliveryAddress').val();
              reviewData.deliveryDate = $('#deliveryDate').val();
              reviewData.currentDate = currentDate;
              reviewData.data = myaddProductTableList;
               $.ajax({
                  url: "/reviewOrderCheckSla",
                  type: "POST",
                  dataType : "json",
                  contentType : "application/json",
                  data: JSON.stringify(reviewData),
                  success: function (result)
                  {
                  if (result.status == 'success') {
                     var myaddProductTableList = result.totalItems;
                        addToCartPushData = myaddProductTableList;
                       pullProductTable(myaddProductTableList,"reviewOrder");
                        alert("Product cancelled successfully");
                    }

                    }
                 });
          }
 });

    function addRemoveDisabledInFilter(bgColor, disabledStatus) {
        $("#select_category, #select_suppliers").css('background-color',bgColor);
        $("#select_category, #select_suppliers").prop('disabled',disabledStatus);
    }

    $('#submit').on('click', function() {
            $('#success_msg').empty();
            $('#error_msg').empty();
            if ($('#domainName').val() != '') {
                var data = "csrfmiddlewaretoken="+$('input[name=csrfmiddlewaretoken]').val()+"&domainName="+$('#domainName').val();
                $.ajax({
                  url: "/renameSchemaURL",
                  type: "POST",
                  dataType: "text",
                  data: data,
                  async:false,
                  success: function (result)
                  {
                    var data = JSON.parse(result);
                    if (data.status == 'success') {
                        $('#success_msg').append(data.success_msg);
                        $("#domainName").prop("disabled",true);
                        $("#submit").prop("disabled",true);
                        setTimeout(function() {
                            $('#success_msg').empty();
                            window.location.href = data.redirect_url;
                        }, 3000);
                    }
                    else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
                        $('#domainName').val('');
                        $('#error_msg').append('Session expired.');
                        $("#domainName").prop("disabled",true);
                        $("#submit").prop("disabled",true);
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 3000);
                    }
                    else{
                        $('#error_msg').append(data.error_msg);
                    }
                  }
                 });
            }
            else {
                $('#error_msg').append('Please enter domain name');
            }
        });

    /* Hide Place Order Menu Tab When page load Start */
        $('#placeOrderMenuTab').hide();
    /* Hide Place Order Menu Tab When page load End */

    $('.orderSubHead').on('click', function() {
        $('.orderSubHead').removeClass('orderSubHeadLeftActive');
        $('.orderSubHead').removeClass('orderSubHeadRightActive');
        $('.orderMenuTab').hide();
        $('#searchBtnDiv').hide();
        if ($(this).attr('id') == 'pastOrdersMenu') {
            $('#'+$(this).attr('id')+'').addClass('orderSubHeadLeftActive');
            $('#pastOrdersMenuTab').show();
            $('#searchBtnDiv').show();
        }
        else {
            $('#'+$(this).attr('id')+'').addClass('orderSubHeadRightActive');
             var data = {"type":"customer"};
                $.ajax({
                  url: "/listOfItemsSupplierOrCustomer",
                  type: "POST",
                  dataType : "json",
                  contentType : "application/json",
                  data: JSON.stringify(data),
                  success: function (result)
                  {
                    var data = result;

                    if (data.status == 'success') {
                    $('#select_suppliers').empty();
                     $('#select_suppliers').append($('<option>', {value:"", text:"Supplier"}))
                     for(i = 0; i < data.totalItems[0].totalSupplier.length; i++){
                        $('#select_suppliers').append($('<option>', {value:data.totalItems[0].totalSupplier[i].relId, text:data.totalItems[0].totalSupplier[i].trdersId__companyName}));
                     }
                     $('#select_category').empty();
                     $('#select_category').append($('<option>', {value:"Category", text:"Category"}))
                     for(i = 0; i < data.totalItems[0].totalCategory.length; i++){
                        $('#select_category').append($('<option>', {value:data.totalItems[0].totalCategory[i].prtCatId, text:data.totalItems[0].totalCategory[i].prtCatName}));
                     }
                     addProductTableList = data.totalItems[0].totalItem;
                     pullProductTable(addProductTableList,"productAdd");
                  }
                  else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                        alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);

                    }
                    else{
                        alert(data.error_msg);
                    }

                  }
                });
            $('#placeOrderDiv').hide();
            $('#deliverDataDiv').show();
            $('.orderSubLi').removeClass('orderSubLiActive');
            $('#placeOrderTabOne').addClass('orderSubLiActive');
            $('#placeOrderTabTwo').addClass('orderSubLiActive');
            $('.containern').removeClass('activeLine');
            $("#dropselect2L").addClass('activeLine');
            $('.circlenew').removeClass('activeCircle');
            //$('#chooseSupplierSelectbox').find('option[value="Multiple"]').attr("selected",true);
            $("#chooseSupplierSelectbox").val("Multiple").change();
            disableSuppliers(false);
            $('#deliveryDate').empty();
            $('#placeOrderMenuTab').show();
        }
    });

    /* Past Orders Script Starts */
        var viewOrderTable = $('#viewOrderTable').DataTable( {"bFilter": false,
            "bLengthChange": false,
            "targets": 'no-sort',
            "bSort": false,
            "info": false,
            "searching": true,
            "order": [],
            "pagingType": "full_numbers",
            language: {
                    paginate: {
                        previous: false,
                        next: false,
                        first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                        last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                    }
            },
            "columns": [
                    { "title": "S.No" },
                    { "title": "Purchase Order No" },
                    { "title": "Vendor Name"},
                    { "title": "Order Date"},
                    { "title": "Delivery Date"},
                    { "title": "Action"},
                ],
                responsive: {
                    details: {
                        renderer: $.fn.dataTable.Responsive.renderer.tableAll()
                    }
                }
                });
                function pullConfirmOrderTable(confirmProductTableList) {
                    viewOrderTable.clear().draw();
                     $.each(confirmProductTableList, function( index, value ) {
                         var sno = index+1;
                        //var statusSpan = "<span id='statusbox"+value.id+"'></span>";
                         //var action = "<input class='cartAddBtn orderViewBtn' id='cartAddBtn_"+value.ordNumber+"' type='button' value='View'>";
                         var ordNum = value.ordNumber.split('-')
                         var res = ordNum[1];
                         if(res == "COPY"){
                             var action = "<ul class='dropdownNew'><li><a href='#actionMenu"+value.ordNumber+"' data-toggle='collapse' aria-expanded='false' class='dropdown-toggle collapsed' style='border-radius: 6px'>Action</a><ul class='list-unstyled menuChildClass collapse' align='center' id='actionMenu"+value.ordNumber+"_"+value.productId__supplierId+"'><li><a href='#' class=' cancelOrDelete' id='delete_"+value.ordNumber+"_"+value.productId__supplierId__supCompanyName+"_"+value.shopCartId__deliveryLocation+"_"+value.productId__supplierId+"' style='border-radius: 6px !important;'>Delete</a></li></ul></li></ul>";
                         }
                         else{
                         var action = "<ul class='dropdownNew'><li><a href='#actionMenu"+value.ordNumber+"' data-toggle='collapse' aria-expanded='false' class='dropdown-toggle collapsed' style='border-radius: 6px !important'>Action</a><ul class='list-unstyled menuChildClass collapse' align='center' id='actionMenu"+value.ordNumber+"'><li><a href='#' class=' cancelOrDelete' id='cancel_"+value.ordNumber+"_"+value.productId__supplierId__supCompanyName+"_"+value.shopCartId__deliveryLocation+"_"+value.productId__supplierId+"'  style='border-radius: 6px 6px 0px 0px;'>Cancel</a></li><li><a href='#' class=' orderViewBtn' id='cartAddBtn_"+value.ordNumber+"_"+value.productId__supplierId+"' >Update</a></li><li><a href='#' class='duplicateBtn' id='duplicateBtn_"+value.ordNumber+"_"+value.productId__supplierId+"'>Duplicate</a></li><li><a href='#' class=' cancelOrDelete' id='delete_"+value.ordNumber+"_"+value.productId__supplierId__supCompanyName+"_"+value.shopCartId__deliveryLocation+"_"+value.productId__supplierId+"'>Delete</a></li><li><a href='#' class='addnewBtn' id='addnewBtn_"+value.ordNumber+"_"+value.shopCartId__expectedDate+"_"+value.shopCartId__totalPrice+"_"+value.productId__supplierId__supCompanyName+"_"+value.shopCartId__expectedTime+"_"+value.shopCartId__deliveryLocation+"_"+value.productId__supplierId+"' style='border-radius: 0px 0px 6px 6px !important;'>Add New</a></li></ul></li></ul>";
                         }
                         //var action = "<div class='dropdown'><button class='dropbtn'>Action<i class='fa fa-caret-down'></i></button><div class='dropdown-content pull-left'><a href='#'>Link 1</a><a href='#'>Link 2</a><a href='#'>Link 3</a></div></div>";
                         var ordNumber = "<a class='' target='_blank' rel='noopener noreferrer' id='cartAddBtn_"+value.ordNumber+"' href='/getOrderPOdetail?orderNo="+value.ordNumber+"&supplierId="+value.productId__supplierId+"' >"+value.ordNumber+"</a>";
                         var orderDate = value.orderDate;
                         var result = orderDate.split('-');
                         var year = result[0];
                         var month = result[1];
                         var day = result[2];
                         viewOrderTable.row.add([sno,ordNumber,value.productId__supplierId__supCompanyName,day+"/"+month+"/"+year,value.shopCartId__expectedDate+"<br>"+value.shopCartId__expectedTime,action]).draw();
                     });
                }
                $.ajax({
                  url: "/viewOrderDetails",
                  type: "POST",
                  dataType : "json",
                  contentType : "application/json",
                  success: function (result)
                  {
                    var data = result;

                    if (data.status == 'success') {
                        confirmProductTableList = data.totalItems[0].totalItem;
                        pullConfirmOrderTable(confirmProductTableList);
                    }
                    else if(data.status == 'error' && data.error_msg != 'sessionexpired'){
                       alert(data.error_msg);
                    }
                    else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
                       alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);
                    }
                    else{
                        alert(data.error_msg);
                    }
                  }
                });

        function appendDynamicContent(modalHead, modalBody, modalFooter) {
            $('#exampleModalLongTitle').append(modalHead);
            $('#modalBody').append(modalBody);
            $('#modalFooter').append(modalFooter);
            $('#exampleModalCenter').modal({backdrop: 'static', keyboard: false})
            $('#exampleModalCenter').modal('toggle');
            $('#exampleModalCenter').show();
        }

    $('#submit').on('click', function() {
            $('#success_msg').empty();
            $('#error_msg').empty();
            if ($('#domainName').val() != '') {
                var data = "csrfmiddlewaretoken="+$('input[name=csrfmiddlewaretoken]').val()+"&domainName="+$('#domainName').val();
                $.ajax({
                  url: "/renameSchemaURL",
                  type: "POST",
                  dataType: "text",
                  data: data,
                  async:false,
                  success: function (result)
                  {
                    var data = JSON.parse(result);
                    if (data.status == 'success') {
                        $('#success_msg').append(data.success_msg);
                        $("#domainName").prop("disabled",true);
                        $("#submit").prop("disabled",true);
                        setTimeout(function() {
                            $('#success_msg').empty();
                            window.location.href = data.redirect_url;
                        }, 3000);
                    }
                    else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
                        $('#domainName').val('');
                        $('#error_msg').append('Session expired.');
                        $("#domainName").prop("disabled",true);
                        $("#submit").prop("disabled",true);
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 3000);
                    }
                    else{
                        alert(data.error_msg);
                    }
                  }
                 });
            }
            else {
                $('#error_msg').append('Please enter domain name');
            }
        });

        var viewPlacedOrderDataTable = $('#viewPlacedOrderDataTable').DataTable( {"bFilter": false,
            "bLengthChange": false,
            "targets": 'no-sort',
            "bSort": false,
            "info": false,
            "searching": true,
            "order": [],
            "pagingType": "full_numbers",
            language: {
                    paginate: {
                        previous: false,
                        next: false,
                        first: '<img src="{% static 'images/leftsidearrow.png' %}" width=15 />',
                        last: '<img src="{% static 'images/rightsidearrow.png' %}" width=15 />'
                    }
            },
            "columns": [
                    { "title": "S.No" },
                    { "title": "Product Code"},
                    { "title": "Product Name"},
                    { "title": "Actual Qty"},
                    { "title": "Qty"},
                    { "title": "Price"},
                    { "title": "Status"},
                    { "title": "Goods Issue"},
                    { "title": "Goods Receive"},
                    { "title": "Action"},

                ],
                columnDefs: [
                     { "width": "2%", "targets": 0 },
                     { "width": "10%", "targets": 1 },
                     { "width": "10%", "targets": 2 },
                     { "width": "10%", "targets": 3 },
                     { "width": "10%", "targets": 4 },
                     { "width": "10%", "targets": 5 },
                     { "width": "10%", "targets": 6 },
                     { "width": "10%", "targets": 7 },
                     { "width": "10%", "targets": 8 },
                     { "width": "5%", "targets": 9 },

                ] });


     $(document).on('click','.duplicateBtn', function() {
        id = $(this).attr('id');
        var result = id.split('_');
        var orderNum = result[1];
        var supplierId = result[2];
        $('#confirmModalPopupTitle').empty();
        $('#confirmModalPopupBodyContent').empty();
        $('#confirmModalPopupTitle').append('Duplicate Order');
        $('#confirmModalPopupBodyContent').append('Are you sure, do you want to create a duplicate copy of this PO?');
         $('#confirmModalPopup').modal('show');
        $(document).on('click',	'#confirmModalPopupSubmit', function() {
            var data = {"orderNum":orderNum,"supplierId":supplierId};
             $.ajax({
                  url: "/OrderDuplicating",
                  type: "POST",
                  dataType : "json",
                  contentType : "application/json",
                  data: JSON.stringify(data),
                  success: function (result)
                  {
                    var data = result;
                    if (data.status == 'success') {
                        alert(data.success_msg);
                        setTimeout(function() {
                            location.reload()
                        }, 2000);
                    }else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                        alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);

                    }else{
                    alert(data.error_msg);
                   }
                  }
              });
        });
    });

    $(document).on('click',	'.addnewBtn', function() {
        id = $(this).attr('id');
        var result = id.split('_');
        var orderNum = result[1];
        var deliveryDate = result[2];
        var totalPrice = result[3];
        var compName = result[4];
        var expectedTime = result[5];
        var deliveryAddressId = result[6];
        var supplierId = result[7];
        var data = {"orderNum":orderNum,"supplierId":supplierId};
         $.ajax({
              url: "/fetchDataByOrderNumber",
              type: "POST",
              dataType : "json",
              contentType : "application/json",
              data: JSON.stringify(data),
              success: function (result)
              {
                var data = result;
                if (data.status == 'success') {
                 $('#confirmNewOrderModalPopupTitle').empty();
                 $('#confirmNewOrderModalPopupTitle').append('New Order');
                    var placedOrdData = data.placedOrdData;
                     newOrderDataTable.clear().draw();
                     $.each(placedOrdData, function( index, value ) {
                        var sno = index+1;
                        var totalPrice = value.quantity * value.currentPrice;
                           newOrderDataTable.row.add([sno,value.itemCode,value.itemName,value.itemCategory__prtCatName,value.quantity,value.uOm__type,value.currentPrice+" "+value.priceUnit__type,totalPrice+" "+value.priceUnit__type]).draw();
                     });
                    $('#confirmNewOrderModalPopup').modal('show');
                    $(document).on('click',	'#confirmNewOrderModalPopupSubmit', function() {
                        var data = {"orderNum":orderNum,"deliveryDate":deliveryDate,"totalPrice":totalPrice,"compName":compName,"expectedTime":expectedTime,"deliveryAddressId":deliveryAddressId};
                         $.ajax({
                              url: "/addNewPlaceOrder",
                              type: "POST",
                              dataType : "json",
                              contentType : "application/json",
                              data: JSON.stringify(data),
                              success: function (result)
                              {
                                var data = result;
                                if (data.status == 'success') {
                                    alert(data.success_msg);
                                    setTimeout(function() {
                                        location.reload()
                                    }, 2000);
                                }else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                                    alert('Session has expired.');
                                    setTimeout(function() {
                                        window.location.href = data.redirect_url;
                                    }, 2000);

                                }else{
                                alert(data.error_msg);
                               }
                              }
                                });
                    });
                }else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                        alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);

                    }else{
                    alert(data.error_msg);
                   }
              }
                });
    });

    $(document).on('click',	'.cancelOrDelete', function() {
        id = $(this).attr('id');
        var result = id.split('_');
        var type = result[0];
        var orderNum = result[1];
        var deliveryAddressId = result[3];
        var supplierId = result[4];
        var compName = result[2];
        if (type == 'cancel'){
            $('#confirmModalPopupTitle').empty();
            $('#confirmModalPopupBodyContent').empty();
            $('#confirmModalPopupTitle').append('Cancel Order');
            $('#confirmModalPopupBodyContent').append('Are you sure, you want to cancel?');
        }
        else if (type == 'delete'){
            $('#confirmModalPopupTitle').empty();
            $('#confirmModalPopupBodyContent').empty();
            $('#confirmModalPopupTitle').append('Delete Order');
            $('#confirmModalPopupBodyContent').append('Are you sure, you want to delete?');
        }
        $('#confirmModalPopup').modal('show');
        $('#confirmModalPopupSubmit').on('click', function() {
            var data = {"orderNum":orderNum,"deliveryAddressId":deliveryAddressId,"compName":compName,"type":type,"supplierId":supplierId};
             $.ajax({
                  url: "/cancelOrDeletePlacedOrder",
                  type: "POST",
                  dataType : "json",
                  contentType : "application/json",
                  data: JSON.stringify(data),
                  success: function (result)
                  {
                    var data = result;
                    if (data.status == 'success') {
                        alert(data.success_msg);
                        setTimeout(function() {
                            location.reload()
                        }, 2000);
                    }else if(data.status == 'error' && data.error_msg == 'sessionexpired'){
                        alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);

                    }else{
                    alert(data.error_msg);
                   }
                  }
             });
         });
    });

    $(document).on('click',	'.orderViewBtn', function() {

        id = $(this).attr('id');
        var result = id.split('_');
        var shopCartId = result[1];
        var supplierId = result[2];
        var data = {"ordNumber":shopCartId,"supplierId":supplierId};
            $.ajax({
              url: "/viewOrderDetails",
              type: "POST",
              dataType : "json",
              contentType : "application/json",
              data: JSON.stringify(data),
              success: function (result)
              {
                var data = result;
                if (data.status == 'success') {
                confirmPlaceOrderTableList = data.totalItems[0].totalItem;
                viewPlacedOrderDataTable.clear().draw();
                 $.each(confirmPlaceOrderTableList, function( index, value ) {
                    var sno = index+1;
                    var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' id='qtytextbox_"+value.productId__itemCode+"' value='"+value.quantity+"' type='text' >";
                    var goodsIssue = "<input type='number'  class='goodsIssueTextBox' id='goodsIssue_"+value.ordNumber+"_"+value.productId__itemCode+"' value="+value.goodsIssue+">";
                   var goodsReceive = "<input type='number'  class='goodsReceiveTextBox' id='goodsReceive_"+value.ordNumber+"_"+value.productId__itemCode+"_"+value.uOm__type+"' value="+value.goodsReceive+">";
                   var comment = "<textarea  class='commentTextBox' id='comment_"+value.ordNumber+"'>"+value.comment+"</textarea>";
                   var action = " ";
                   if(value.ordstatus == 'Accept'){
                        action = "<a id='editPlacedOrders_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' class='editPlacedOrders' href='#'><i class='fa fa-pencil-square-o' aria-hidden='true' style='color:green'></i></a>&nbsp;<a class='saveBtn' id='saveBtn_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' style='display:none;margin-top:-20px;' href='#' ><i class='fa fa-floppy-o' aria-hidden='true' style='color:green'></i></a>";
                        var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='Pending'>Pending</option><option value='Reject'>Reject</option> <option value='Closed'>Closed</option></select>";
                   }
                   else if(value.ordstatus == 'Pending' ){
                   var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='Reject'>Reject</option><option value='Accept'>Accept</option> <option value='Closed'>Closed</option></select>";
                         action = "<a id='editPlacedOrders_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' class='editPlacedOrders' href='#'><i class='fa fa-pencil-square-o' aria-hidden='true' style='color:green'></i></a>&nbsp;<a class='saveBtn' id='saveBtn_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' style='display:none;margin-top:-20px !important' href='#' ><i class='fa fa-floppy-o' aria-hidden='true' style='color:green'></i></a>";
                   }else if(value.ordstatus == 'Closed'){
                   var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='Pending'>Pending</option><option value='Accept'>Accept</option><option value='Reject'>Reject</option> </select>";
                   }else{
                   var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='pending'>Pending</option><option value='Accept'>Accept</option><option value='Closed'>Closed</option></select>";
                   }
                   viewPlacedOrderDataTable.row.add([sno,value.productId__itemCode,value.productId__itemName,value.actualQuantity+" "+value.uOm__type,qtyinput,value.price+" "+value.priceUnit__type,status,goodsIssue,goodsReceive,action]).draw();
                 });
                     $(".acceptOrReject").prop("disabled", true);
                     $(".qtytextbox").prop("disabled", true);
                     $(".goodsReceiveTextBox").prop("disabled", true);
                     $(".goodsIssueTextBox").prop("disabled", true);
                     $('#viewPlacedOrderModal').modal('show');
              }

              else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
                   alert('Session has expired.');
                    setTimeout(function() {
                        window.location.href = data.redirect_url;
                    }, 2000);

                }else {
               alert(data.error_msg);
              }
              }
            });
    });

      $(document).on('change','.qtytextbox', function() {
            var name = $(this).attr('name');
            var qty = $("input[name="+name+"]").val();
            var resultName = name.split('_');
            var itemCode = resultName[1];
            var id = $(this).attr('id');
            var resultId = id.split('_');
            var price = resultId[1];
            if(qty){
                var totalPrice = qty*price;
                var totalValData = parseFloat(Math.round(totalPrice * 100) / 100).toFixed(2);
                var uom = resultId[2];
                $("#totalPriceBox"+itemCode).html("");
                $("#totalPriceBox"+itemCode).html(totalValData+" "+uom);
            }
            else{
                $("#totalPriceBox"+itemCode).html("");
            }
      });
      $(document).on('change','.goodsReceiveTextBox', function() {
            var id = $(this).attr('id');
            var result = id.split('_');
            var orderNo = result[1];
            var itemCode = result[2];
            var uOm = result[3];
            var goodsReceive =  $('#goodsReceive_'+orderNo+'_'+itemCode+'_'+uOm).val();
            var goodsIssue =  $('#goodsIssue_'+orderNo+'_'+itemCode).val();
            if((parseInt(goodsReceive) != goodsReceive) && (uOm == "Nos" || uOm == "Pkt" || uOm == "Pcs") ){
                alert('Please enter the valid goods receive qty');
                $('#goodsReceive_'+orderNo+'_'+itemCode+'_'+uOm).val('');
                $('#goodsReceive_'+orderNo+'_'+itemCode+'_'+uOm).focus();
                return false;
            }
            else if(goodsReceive > goodsIssue){
                alert('Goods Received qty should not be greater than Goods Issue qty');
                $('#goodsReceive_'+orderNo+'_'+itemCode+'_'+uOm).val('');
                $('#goodsReceive_'+orderNo+'_'+itemCode+'_'+uOm).focus();
                return false;
            }
        });

      $(document).on('click', '.editPlacedOrders', function() {
        var id = $(this).attr('id');

        var result = id.split('_');
        var status = $('#acceptOrRejectStatus_'+result[2]+'_'+result[3]).val();
        if(result[5]=='false'){
             $('#qtytextbox_'+result[3]).prop("disabled", false);
             $('#goodsReceive_'+result[1]+'_'+result[3]+'_'+result[6]).prop("disabled", false);
             $('#goodsIssue_'+result[1]+'_'+result[3]).prop("disabled", false);
             $('#acceptOrRejectStatus_'+result[1]+'_'+result[3]).prop("disabled", false);
        }
        else if (status == 'Accept'){
            $('#goodsReceive_'+result[1]+'_'+result[3]+'_'+result[6]).prop("disabled", false);
            $('#goodsReceive_'+result[1]+'_'+result[3]+'_'+result[6]).focus();
            $('#qtytextbox_'+result[3]).prop("disabled", true);
        }
        else{
            $('#qtytextbox_'+result[3]).prop("disabled", false);
            $('#qtytextbox_'+result[3]).focus();
        }
         $('#editPlacedOrders_'+result[1]+'_'+result[2]+'_'+result[3]+'_'+result[4]+'_'+result[5]+'_'+result[6]).css('display', 'none');
         $('#saveBtn_'+result[1]+'_'+result[2]+'_'+result[3]+'_'+result[4]+'_'+result[5]+'_'+result[6]).css('display', 'block');
         //$('#saveBtn_'+result[1]+'_'+result[2]+'_'+result[3]+'_'+result[4]).css('float', 'left');
         //$('#saveBtn_'+result[1]+'_'+result[2]+'_'+result[3]+'_'+result[4]).css('padding', '5px');
         $('#deleteBtn_'+result[1]+'_'+result[2]).css('float', 'left');
         $('#deleteBtn_'+result[1]+'_'+result[2]).css('padding', '5px');

         $('#qtytextbox_'+result[3]).keypress(function(event) {
              if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
                event.preventDefault();
              }
         });
  });

  $(document).on('click', '.saveBtn', function() {
    var id = $(this).attr('id');
    var result = id.split('_');
    var ordNumber = result[1];
    var shopCartId = result[2];
    var productCode = result[3];
    var supplierId = result[4];
    var connectionStatus = result[5];
    var qty = $('#qtytextbox_'+result[3]).val();
    var qtyres = qty.split(' ');
    var goodsReceive = $('#goodsReceive_'+result[1]+'_'+result[3]+'_'+result[6]).val();
    var goodsIssue = $('#goodsIssue_'+result[1]+'_'+result[3]).val();
    var status = $('#acceptOrRejectStatus_'+result[1]+'_'+result[3]).val();
    if(qty == ''){
        alert('Please enter Qty');
        $('#qtytextbox_'+result[3]).focus();
        return false;
    }
    else if(goodsReceive > goodsIssue){
        alert('Goods Received qty should not be greater than Goods Issue qty');
        $('#goodsReceive_'+result[1]+'_'+result[3]).val('');
        $('#goodsReceive_'+result[1]+'_'+result[3]).focus();
        return false;
    }
    else{
        var data = {"ordNumber":ordNumber,"type":"update","qty":qtyres[0],"itemCode":productCode,'goodsReceive':goodsReceive,'goodsIssue':goodsIssue,'supplierId':supplierId,'status':status};
            $.ajax({
              url: "/orderFulfillmentCustomer",
              type: "POST",
              dataType : "json",
              contentType : "application/json",
              data: JSON.stringify(data),
              success: function (result)
              {
                var data = result;
                if (data.status == 'success') {
                      var data = {"ordNumber":ordNumber,'supplierId':supplierId};
                        $.ajax({
                          url: "/viewOrderDetails",
                          type: "POST",
                          dataType : "json",
                          contentType : "application/json",
                          data: JSON.stringify(data),
                          success: function (result)
                          {
                            var data = result;
                            if (data.status == 'success') {
                           alert(data.success_msg);
                            confirmPlaceOrderTableList = data.totalItems[0].totalItem;
                            viewPlacedOrderDataTable.clear().draw();
                             $.each(confirmPlaceOrderTableList, function( index, value ) {
                                    var sno = index+1;
                                  var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' id='qtytextbox_"+value.productId__itemCode+"' value='"+value.quantity+"' type='text' >";
                        var goodsIssue = "<input type='number'  class='goodsIssueTextBox' id='goodsIssue_"+value.ordNumber+"_"+value.productId__itemCode+"' value="+value.goodsIssue+">";
                       var goodsReceive = "<input type='number'  class='goodsReceiveTextBox' id='goodsReceive_"+value.ordNumber+"_"+value.productId__itemCode+"_"+value.uOm__type+"' value="+value.goodsReceive+">";
                       var comment = "<textarea  class='commentTextBox' id='comment_"+value.ordNumber+"'>"+value.comment+"</textarea>";
                       var action = " ";
                       if(value.ordstatus == 'Accept'){
                            action = "<a id='editPlacedOrders_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' class='editPlacedOrders' href='#'><i class='fa fa-pencil-square-o' aria-hidden='true' style='color:green'></i></a>&nbsp;<a class='saveBtn' id='saveBtn_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' style='display:none;margin-top:-20px;' href='#' ><i class='fa fa-floppy-o' aria-hidden='true' style='color:green'></i></a>";
                            var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='Pending'>Pending</option><option value='Reject'>Reject</option> <option value='Closed'>Closed</option></select>";
                       }
                       else if(value.ordstatus == 'Pending' ){
                       var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='Reject'>Reject</option><option value='Accept'>Accept</option> <option value='Closed'>Closed</option></select>";
                             action = "<a id='editPlacedOrders_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' class='editPlacedOrders' href='#'><i class='fa fa-pencil-square-o' aria-hidden='true' style='color:green'></i></a>&nbsp;<a class='saveBtn' id='saveBtn_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' style='display:none;margin-top:-20px !important' href='#' ><i class='fa fa-floppy-o' aria-hidden='true' style='color:green'></i></a>";
                       }else if(value.ordstatus == 'Closed'){
                       var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='Pending'>Pending</option><option value='Accept'>Accept</option><option value='Reject'>Reject</option> </select>";
                       }else{
                       var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"_"+value.productId__itemCode+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='pending'>Pending</option><option value='Accept'>Accept</option><option value='Closed'>Closed</option></select>";
                       }
                       viewPlacedOrderDataTable.row.add([sno,value.productId__itemCode,value.productId__itemName,value.actualQuantity+" "+value.uOm__type,qtyinput,value.price+" "+value.priceUnit__type,status,goodsIssue,goodsReceive,action]).draw();
                     });
                         $(".acceptOrReject").prop("disabled", true);
                         $(".qtytextbox").prop("disabled", true);
                         $(".goodsReceiveTextBox").prop("disabled", true);
                         $(".goodsIssueTextBox").prop("disabled", true);
                         $('#viewPlacedOrderModal').modal('show');

                          }
                          else if(data.status == 'error' && data.error_msg != 'sessionexpired'){

                             $('#viewPlacedOrderModal').modal('hide');
                            alert(data.error_msg);
                          }
                          else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
                                   alert('Session has expired.');
                                    setTimeout(function() {
                                        window.location.href = data.redirect_url;
                                    }, 2000);
                                }
                           else{
                                alert(data.error_msg);
                            }
                          }
                        });


                }else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
                       alert('Session has expired.');
                        setTimeout(function() {
                            window.location.href = data.redirect_url;
                        }, 2000);
                    }
               else{
                    alert(data.error_msg);
                }
              }
            });
    }
  });

  $(document).on('click', '.deleteBtn', function() {
    var id = $(this).attr('id');
    var result = id.split('_');
    var ordNumber = result[1];
    var shopCartId = result[2];

    var data = {"orderNo":ordNumber,"type":"delete"};
        $.ajax({
          url: "/placedOrderDelete",
          type: "POST",
          dataType : "json",
          contentType : "application/json",
          data: JSON.stringify(data),
          success: function (result)
          {
            var data = result;
            if (data.status == 'success') {
                 var data = {"shopCartId":shopCartId};
                    $.ajax({
                      url: "/viewOrderDetails",
                      type: "POST",
                      dataType : "json",
                      contentType : "application/json",
                      data: JSON.stringify(data),
                      success: function (result)
                      {
                        var data = result;
                        if (data.status == 'success') {
                        alert(data.success_msg);
                        confirmPlaceOrderTableList = data.totalItems[0].totalItem;
                        viewPlacedOrderDataTable.clear().draw();
                         $.each(confirmPlaceOrderTableList, function( index, value ) {
                         var sno = index+1;
                           var status = "<select name='acceptOrReject' id='acceptOrRejectStatus_"+value.ordNumber+"' class='acceptOrReject'><option value="+value.ordstatus+">"+value.ordstatus+"</option><option value='pending'>Pending</option><option value='Accept'>Accept</option><option value='Reject'>Reject</option> </select>";
                           var qtyinput = "<input class='qtytextbox' name='qtytextbox_"+value.id+"' id='qtytextbox_"+value.ordNumber+"' value='"+value.quantity+" "+value.uOm__type+"' type='text' >";

                           var comment = "<textarea  class='commentTextBox' id='comment_"+value.ordNumber+"'>"+value.comment+"</textarea>";
                           var action = "<a id='editPlacedOrders_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' class='editPlacedOrders' href='#'><i class='fa fa-pencil-square-o' aria-hidden='true' style='color:green' ></i></a>&nbsp;<a class='saveBtn' id='saveBtn_"+value.ordNumber+"_"+shopCartId+"_"+value.productId__itemCode+"_"+value.supplierId+"_"+value.connectedStatus+"_"+value.uOm__type+"' style='display:none;' href='#' ><i class='fa fa-floppy-o' aria-hidden='true' style='color:green' ></i></a>&nbsp;<a class='deleteBtn' id='deleteBtn_"+value.ordNumber+"_"+shopCartId+"' href='#' ><i class='fa fa-trash-o' aria-hidden='true' style='color:red' ></i></a>";
                            viewPlacedOrderDataTable.row.add([sno,value.ordNumber,value.productId__relId__trdersId__companyName,value.productId__itemCode,value.productId__itemName,qtyinput,value.price+" "+value.priceUnit__type,status,comment,action]).draw();

                         });
                         $(".acceptOrReject").prop("disabled", true);
                         $(".qtytextbox").prop("disabled", true);
                         $('#viewPlacedOrderModal').modal('show');
                      }
                      else if(data.status == 'error'&& data.error_msg != 'sessionexpired'){
                         $('#viewPlacedOrderModal').modal('toggle');
                         location.reload();
                         alert(data.error_msg);
                      }
                      else if (data.status == 'error' && data.error_msg == 'sessionexpired') {
                         alert('Session has expired.');
                            setTimeout(function() {
                                window.location.href = data.redirect_url;
                            }, 2000);
                        }
                        else{
                            alert(data.error_msg);
                        }
                      }
                    });
            }
          }
        });
  });

    /* Customize search option for DataTable Start */
        $('#searchOption').on( 'keyup', function () {
              $('#viewOrderTable').DataTable().search(this.value).draw();
        });
    /* Customize search option for DataTable End */
    /* Customize search option for Product DataTable Start */
        $('#searchOptionOrder').on( 'keyup', function () {
              $('#addProductTable').DataTable().search(this.value).draw();
        });
        $(document).on('keyup', '#searchOptionOrder', function () {
             $('#addProductTable').DataTable().search(this.value).draw();
        });
    /* Customize search option for Product DataTable End */
/* Past Orders Script Ends */
  });
</script>
{% endblock %}